{
  "meta": {
    "instanceId": "cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7"
  },
  "nodes": [
    {
      "id": "1092ab50-67a0-4e50-8c10-f05f70b45f56",
      "name": "Venafi TLS Protect Cloud",
      "type": "n8n-nodes-base.venafiTlsProtectCloud",
      "position": [
        2860,
        1700
      ],
      "parameters": {
        "options": {},
        "commonName": "={{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value.match(/^(\\*\\.)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$/g).toString() }}",
        "generateCsr": true,
        "applicationId": "f3c15c80-7151-11ef-9a22-abeac49f7094",
        "additionalFields": {
          "organizationalUnits": [
            "={{ $json.name }}"
          ]
        },
        "certificateIssuingTemplateId": "d28d82b1-714b-11ef-9026-7bb80b32867a"
      },
      "credentials": {
        "venafiTlsProtectCloudApi": {
          "id": "WU38IpfutNNkJWuo",
          "name": "Venafi TLS Protect Cloud account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "0c1f1b92-2da4-413f-a4cc-68c816e8511c",
      "name": "Parse Webhook",
      "type": "n8n-nodes-base.set",
      "position": [
        440,
        1100
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "e63f9299-a19d-4ba1-93b0-59f458769fb2",
              "name": "response",
              "type": "object",
              "value": "={{ $json.body.payload }}"
            }
          ]
        }
      },
      "typeVersion": 3.3
    },
    {
      "id": "95fb1907-c9e0-4164-b0b0-c3691bb46b9a",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        108.34675483142371,
        741.4892041682327
      ],
      "parameters": {
        "color": 7,
        "width": 466.8168310000617,
        "height": 556.7924159157113,
        "content": "![Imgur](https://i.imgur.com/iKyMV0N.png)  \n## ì´ë²¤íŠ¸ ì›¹í›… íŠ¸ë¦¬ê±°  \nì²« ë²ˆì§¸ ë…¸ë“œëŠ” Subscription Events APIë¥¼ í†µí•´ Slack APIì—ì„œ ëª¨ë“  ë©”ì‹œì§€ë¥¼ ë°›ìŠµë‹ˆë‹¤. êµ¬ë… ì´ë²¤íŠ¸ API ì„¤ì •ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [ì—¬ê¸°ë¥¼ í´ë¦­](https://api.slack.com/apis/connections/events-api)í•˜ì„¸ìš”.  \n  \në‘ ë²ˆì§¸ ë…¸ë“œëŠ” Slackì—ì„œ í˜ì´ë¡œë“œë¥¼ ì¶”ì¶œí•˜ì—¬ n8nì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ê°ì²´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "4dd8cbbe-278c-4c86-bcd7-9fb0eff619b2",
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        580,
        420
      ],
      "parameters": {
        "color": 7,
        "width": 566.0553219408072,
        "height": 999.0925226187064,
        "content": "## n8nì„ ì‚¬ìš©í•œ íš¨ìœ¨ì ì¸ Slack ìƒí˜¸ì‘ìš© ì²˜ë¦¬\n\nì´ ì›Œí¬í”Œë¡œì˜ ì´ ì„¹ì…˜ì€ íŠ¹ì • íŠ¸ë¦¬ê±°ì™€ ì¡°ê±´ì— ë”°ë¼ Slackì—ì„œ ë©”ì‹œì§€ì™€ ì œì¶œì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ë¼ìš°íŒ…í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. Slack ìƒí˜¸ì‘ìš©ì´ ë°œìƒí•  ë•Œâ€”ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ìê°€ ì·¨ì•½ì  ìŠ¤ìº”ì„ íŠ¸ë¦¬ê±°í•˜ê±°ë‚˜ ëª¨ë‹¬ì„ í†µí•´ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°â€”ì›Œí¬í”Œë¡œëŠ” ë©”ì‹œì§€ë¥¼ ì ì ˆí•œ ì‘ì—…ìœ¼ë¡œ ì§€ëŠ¥ì ìœ¼ë¡œ ë¼ìš°íŒ…í•©ë‹ˆë‹¤:\n\n- **ë™ì  ë¼ìš°íŒ…**: ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ Slack ìƒí˜¸ì‘ìš©ì˜ ì„±ê²©ì„ ê²°ì •í•©ë‹ˆë‹¤. ìŠ¤ìº”ì„ ì‹œì‘í•˜ëŠ” ì§ì ‘ì ì¸ ëª…ë ¹ì¸ì§€ ë˜ëŠ” ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” ìš”ì²­ì¸ì§€ ì—¬ë¶€ì…ë‹ˆë‹¤.\n- **ëª¨ë‹¬ ê´€ë¦¬**: ëª¨ë‹¬ ì œëª©ê³¼ `callback_id`ì— ë”°ë¼ í–‰ë™ì„ êµ¬ë¶„í•˜ì—¬, ê° ìœ í˜•ì˜ ì œì¶œì´ ê·¸ ë§¥ë½ì— ë”°ë¼ ì²˜ë¦¬ë˜ë„ë¡ í•©ë‹ˆë‹¤.\n- **ê°„ì†Œí™”ëœ ì‘ë‹µ**: ë¼ìš°íŒ… í›„, ì›Œí¬í”Œë¡œëŠ” í•„ìš”í•œ ì‘ë‹µì´ë‚˜ í–‰ë™ì„ ì¦‰ì‹œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ëª¨ë‹¬ íŒì—…ì„ ë‹«ê³  Slackì— ì ì ˆí•œ í™•ì¸ì´ë‚˜ ë°ì´í„°ë¥¼ ì‘ë‹µí•˜ëŠ” ê²ƒì´ í¬í•¨ë©ë‹ˆë‹¤.\n\n**ëª©ì **: ì´ ë©”ì»¤ë‹ˆì¦˜ì€ Slack ë‚´ ëª¨ë“  ìƒí˜¸ì‘ìš©ì´ ë¹ ë¥´ê³  ì •í™•í•˜ê²Œ ì²˜ë¦¬ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ìœ¼ë¡œ ì‘ë‹µê³¼ í–‰ë™ì„ ìë™í™”í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ê³¼ ì›Œí¬í”Œë¡œ íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "db8aabd8-d00d-4d50-9f97-443eba7c7c90",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1153.6255461332685,
        516.1718360212528
      ],
      "parameters": {
        "color": 7,
        "width": 396.6025898621133,
        "height": 652.6603582798184,
        "content": "![Imgur](https://i.imgur.com/iKyMV0N.png)  \n## ëª¨ë‹¬ íŒì—… í‘œì‹œ  \nì´ ì„¹ì…˜ì€ ëª¨ë‹¬ ì°½ì„ ì—´ì–´ ë‚˜ì¤‘ì— Virustotalë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ê³ , ê·¸ ê²°ê³¼ì— ë”°ë¼ Venafi ë˜ëŠ” Slackìœ¼ë¡œ ìˆ˜ë™ ìŠ¹ì¸ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.  \n  \nëª¨ë‹¬ì€ ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ëª¨ë‹¬ì€ ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë°”ì¼ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤! ë˜í•œ, ë©”ì‹œì§€ ìì²´ê°€ ë²„íŠ¼ì´ë‚˜ í•„ë“œ ì…ë ¥ê³¼ ê°™ì€ ìš”ì†Œë¥¼ í¬í•¨í•˜ë©´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n  \nìì„¸í•œ ë‚´ìš©ì€ [ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”](https://api.slack.com/surfaces/modals)"
      },
      "typeVersion": 1
    },
    {
      "id": "a86e0b86-0740-4b77-831a-52413983818e",
      "name": "Close Modal Popup",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        960,
        1200
      ],
      "parameters": {
        "options": {},
        "respondWith": "noData"
      },
      "typeVersion": 1.1
    },
    {
      "id": "a5abc206-6b10-42bc-9196-bcedacdb3726",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -580,
        740
      ],
      "parameters": {
        "width": 675.1724774900403,
        "height": 972.8853473866498,
        "content": "![n8n](https://i.imgur.com/lKnBNnH.png)  \n## Venafi Slack CertBotìœ¼ë¡œ ë³´ì•ˆ ìš´ì˜ì„ ê°•í™”í•˜ì„¸ìš”!\n\n**Venafi Slack CertBot**ì€ Slackì—ì„œ ì§ì ‘ ì¦‰ì‹œ ë³´ì•ˆ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ì „ëµì ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ë¥¼ í†µí•´ ìµœì¢… ì‚¬ìš©ìê°€ ì¸ì¦ì„œ ì„œëª… ìš”ì²­(CSR)ì„ ì œì¶œí•˜ë©´, ìš”ì²­ëœ ë„ë©”ì¸ì˜ Virustotal ë¶„ì„ ê²°ê³¼ì— ë”°ë¼ ìë™ìœ¼ë¡œ ìŠ¹ì¸ë˜ê±°ë‚˜ Secops íŒ€ì— ìˆ˜ë™ ìŠ¹ì¸ì„ ìœ„í•´ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ëŠ” ìš”ì²­ì„ ì¤‘ì•™í™”í•˜ëŠ” ë° ë„ì›€ì´ ë  ë¿ë§Œ ì•„ë‹ˆë¼, ìë™í™”ëœ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìš”ì²­ì„ ê¸°ë¡í•˜ê³  ë¶„ì„í•˜ì—¬ ì¡°ì§ì˜ ë³´ì•ˆ ì¸ì¦ì„ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \n\n**ì›Œí¬í”Œë¡œìš° í•˜ì´ë¼ì´íŠ¸:**  \n- **ëŒ€í™”í˜• ëª¨ë‹¬**: Slack ëª¨ë‹¬ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤ìº” êµ¬ì„± ë° ë³´ê³ ì„œ ìƒì„±ì„ ìœ„í•œ ì‚¬ìš©ì ì…ë ¥ì„ ìˆ˜ì§‘í•˜ë©°, ë³µì¡í•œ ì‘ì—…ì— ì‚¬ìš©ì ì¹œí™”ì ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.  \n- **ë™ì  ì›Œí¬í”Œë¡œìš° ì‹¤í–‰**: Venafiì™€ ì›í™œí•˜ê²Œ í†µí•©ë˜ì–´ CSR ìƒì„±ì„ ì‹¤í–‰í•˜ë©°, ë¬¸ì œê°€ ë°œê²¬ë  ê²½ìš° AIê°€ ë§ì¶¤ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì—¬ ë‹¨ì¼ ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ Slack íŒ€ ì±„ë„ì— ìˆ˜ë™ ìŠ¹ì¸ì„ ìœ„í•´ ì „ë‹¬í•©ë‹ˆë‹¤.\n\n**ìš´ì˜ íë¦„:**  \n- **ì›¹í›… ë°ì´í„° íŒŒì‹±**: Slackì—ì„œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ë¥¼ ìº¡ì²˜í•˜ê³  íŒŒì‹±í•˜ì—¬ ì‚¬ìš©ì ëª…ë ¹ì„ ì •í™•íˆ ì´í•´í•©ë‹ˆë‹¤.  \n- **ì‘ì—… ì‹¤í–‰**: ì‚¬ìš©ìì˜ ì„ íƒì— ë”°ë¼ ì›Œí¬í”Œë¡œìš° ë‚´ì—ì„œ ìë™ Virustotal ìŠ¤ìº”ê³¼ ê°™ì€ ë‹¤ë¥¸ ì‘ì—…ì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.  \n- **Slack ì‘ë‹µ**: ëª¨ë“  ìƒí˜¸ì‘ìš©ì„ ì¸ì •í•˜ì—¬ ëª¨ë‹¬ íŒì—…ì„ ê´€ë¦¬í•˜ê³  ì ì ˆí•œ ì‘ë‹µì„ ë³´ë‚´ ì‚¬ìš©ì ê²½í—˜ì„ ë¶€ë“œëŸ½ê²Œ ìœ ì§€í•©ë‹ˆë‹¤.\n\n**ì„¤ì • ì§€ì¹¨:**  \n- Slack ë° Qualys API í†µí•©ì´ ì›í™œí•˜ê²Œ ì‘ë™í•˜ë„ë¡ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.  \n- ì¡°ì§ì˜ ìš´ì˜ í”„ë¡œí† ì½œê³¼ ë³´ì•ˆ ì •ì±…ì— ë§ê²Œ ëª¨ë‹¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆí•©ë‹ˆë‹¤.  \n- ì›Œí¬í”Œë¡œìš°ê°€ Slack ëª…ë ¹ì— ì •í™•íˆ ì‘ë‹µí•˜ê³  Qualys í†µí•©ì´ ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.\n\n**ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?**  \n- Venafiì˜ [ë¬¸ì„œ](https://docs.venafi.com/)ë¥¼ íƒìƒ‰í•˜ê±°ë‚˜ [n8n ì»¤ë®¤ë‹ˆí‹°](https://community.n8n.io)ì—ì„œ ì„¤ì • ë° ì»¤ìŠ¤í„°ë§ˆì´ì œì´ì…˜ì— ëŒ€í•œ ìì„¸í•œ ì§€ì¹¨ì„ ë°›ìœ¼ì„¸ìš”.\n\nSlack í™˜ê²½ì— ì´ ë´‡ì„ ë°°í¬í•˜ì—¬ ë³´ì•ˆ ìš´ì˜ì˜ íš¨ìœ¨ì„±ê³¼ ì‘ë‹µì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¤ê³ , CSRì„ í”„ë¡œì•¡í‹°ë¸Œí•˜ê²Œ ê´€ë¦¬í•˜ì„¸ìš”."
      },
      "typeVersion": 1
    },
    {
      "id": "352680c7-3b77-4fc1-81eb-8b5495747d89",
      "name": "Respond to Slack Webhook - Vulnerability",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        960,
        1000
      ],
      "parameters": {
        "options": {},
        "respondWith": "noData"
      },
      "typeVersion": 1.1
    },
    {
      "id": "7e2991c3-14ee-478c-b9b6-9dd58590dde9",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1160,
        860
      ],
      "parameters": {
        "color": 5,
        "width": 376.26546828439086,
        "height": 113.6416448104651,
        "content": "ğŸ™‹ ìŠ¬ë™ ìê²© ì¦ëª…ì„ ìŠì§€ ë§ˆì„¸ìš”!  \në‹¤í–‰íˆ n8nì´ ì‰½ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ì¼ë°˜ ìŠ¬ë™ ë…¸ë“œì— ìê²© ì¦ëª…ì„ ì¶”ê°€í•œ ê²½ìš°, ì´ HTTP ë…¸ë“œë¥¼ ë“œë¡­ë‹¤ìš´ì„ í†µí•´ ë³€ê²½í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "97b8942b-1ec5-437f-9c51-2188cc9a9d6f",
      "name": "Venafi Request Certificate",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1240,
        1000
      ],
      "parameters": {
        "url": "https://slack.com/api/views.open",
        "method": "POST",
        "options": {},
        "jsonBody": "= {\n \"trigger_id\": \"{{ $('Parse Webhook').item.json['response']['trigger_id'] }}\",\n \"external_id\": \"Idea Selector\",\n \"view\": {\n\t\"type\": \"modal\",\n\t\"callback_id\": \"certificate_request_modal\",\n\t\"title\": {\n\t\t\"type\": \"plain_text\",\n\t\t\"text\": \"Request New Certificate\"\n\t},\n\t\"submit\": {\n\t\t\"type\": \"plain_text\",\n\t\t\"text\": \"Request\"\n\t},\n\t\"close\": {\n\t\t\"type\": \"plain_text\",\n\t\t\"text\": \"Cancel\"\n\t},\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"image\",\n\t\t\t\"image_url\": \"https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=640&width=640\",\n\t\t\t\"alt_text\": \"delicious tacos\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"input\",\n\t\t\t\"block_id\": \"domain_name_block\",\n\t\t\t\"label\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Domain Name\"\n\t\t\t},\n\t\t\t\"element\": {\n\t\t\t\t\"type\": \"plain_text_input\",\n\t\t\t\t\"action_id\": \"domain_name_input\",\n\t\t\t\t\"placeholder\": {\n\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\"text\": \"Enter the domain name\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"input\",\n\t\t\t\"block_id\": \"validity_period_block\",\n\t\t\t\"label\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Validity Period\"\n\t\t\t},\n\t\t\t\"element\": {\n\t\t\t\t\"type\": \"static_select\",\n\t\t\t\t\"action_id\": \"validity_period_select\",\n\t\t\t\t\"placeholder\": {\n\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\"text\": \"Select a validity period\"\n\t\t\t\t},\n\t\t\t\t\"options\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\t\"text\": \"1 Year\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"value\": \"P1Y\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\t\"text\": \"2 Years\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"value\": \"P2Y\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"input\",\n\t\t\t\"block_id\": \"optional_note_block\",\n\t\t\t\"optional\": true,\n\t\t\t\"label\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"Optional Note\"\n\t\t\t},\n\t\t\t\"element\": {\n\t\t\t\t\"type\": \"plain_text_input\",\n\t\t\t\t\"action_id\": \"optional_note_input\",\n\t\t\t\t\"multiline\": true,\n\t\t\t\t\"placeholder\": {\n\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\"text\": \"Add any extra information (e.g., usage context, urgency)\"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t]\n}\n}",
        "sendBody": true,
        "jsonQuery": "{\n \"Content-type\": \"application/json\"\n}",
        "sendQuery": true,
        "specifyBody": "json",
        "specifyQuery": "json",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "slackApi"
      },
      "credentials": {
        "slackApi": {
          "id": "hkcQkp6qhtiMzBEX",
          "name": "certbot"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "12c50bad-8aab-4bab-8790-153d9e484762",
      "name": "Extract Fields",
      "type": "n8n-nodes-base.set",
      "position": [
        1200,
        1460
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "39808a24-60f6-4f4b-8f4c-4c2aa3850b4f",
              "name": "domain",
              "type": "string",
              "value": "={{ $json.response.view.state.values.domain_name_block.domain_name_input.value }}"
            },
            {
              "id": "27c905be-18cc-434f-8af0-a08ee23a168f",
              "name": "validity",
              "type": "string",
              "value": "={{ $json.response.view.state.values.validity_period_block.validity_period_select.selected_option.value }}"
            },
            {
              "id": "ba1382e5-0629-4276-9858-34bcb59cc85a",
              "name": "note",
              "type": "string",
              "value": "={{ $json.response.view.state.values.optional_note_block.optional_note_input.value }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "f16a97d7-639e-4ec9-b003-b4ee4fdf8666",
      "name": "Get Slack User ID",
      "type": "n8n-nodes-base.set",
      "position": [
        1200,
        2020
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "53dfe019-d91d-4f5c-b279-f8b3fde98bf1",
              "name": "id",
              "type": "string",
              "value": "={{ $json.response.user.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "2a6af9ae-3916-4993-b2b3-a737f54f7a37",
      "name": "Translate Slack User ID to Email",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        1520,
        2020
      ],
      "parameters": {
        "options": {
          "waitForSubWorkflow": true
        },
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "afeVlIVyoIF8Psu4",
          "cachedResultName": "Slack ID to Email"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "19541f84-0d97-4711-80ed-d36a5d517d9b",
      "name": "VirusTotal HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1440,
        1460
      ],
      "parameters": {
        "": "",
        "url": "=https://www.virustotal.com/api/v3/domains/{{ $json.domain }}",
        "method": "GET",
        "options": {},
        "sendBody": false,
        "sendQuery": false,
        "curlImport": "",
        "infoMessage": "",
        "sendHeaders": true,
        "authentication": "none",
        "specifyHeaders": "keypair",
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json"
            },
            {
              "name": "X-Apikey",
              "value": "455144dac89b783b2f5421578b9ab4072adebfc011c969ba384d1c8f0e2ce39e"
            }
          ]
        },
        "httpVariantWarning": "",
        "provideSslCertificates": false
      },
      "credentials": {
        "virusTotalApi": {
          "id": "JRK1xDyMiseROCmY",
          "name": "VirusTotal account 2"
        }
      },
      "typeVersion": 4.2,
      "extendsCredential": "virusTotalApi"
    },
    {
      "id": "4a0e0a71-b433-479b-87b7-7200537009af",
      "name": "Summarize output to save on tokens",
      "type": "n8n-nodes-base.set",
      "position": [
        1760,
        1460
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "2c4689a3-4b72-4240-8a0f-2fa00d33c553",
              "name": "data.attributes.last_analysis_stats.malicious",
              "type": "number",
              "value": "={{ $json.data.attributes.last_analysis_stats.malicious }}"
            },
            {
              "id": "59db6f41-1cf1-4feb-8120-8c50fadc5c9e",
              "name": "data.attributes.last_analysis_stats.suspicious",
              "type": "number",
              "value": "={{ $json.data.attributes.last_analysis_stats.suspicious }}"
            },
            {
              "id": "b55e7d39-0358-4863-8147-c5ce2b65ea96",
              "name": "data.attributes.last_analysis_stats.undetected",
              "type": "number",
              "value": "={{ $json.data.attributes.last_analysis_stats.undetected }}"
            },
            {
              "id": "ecd98a37-cb8b-48cd-bd3d-9c8bf777c5ca",
              "name": "data.attributes.last_analysis_stats.harmless",
              "type": "number",
              "value": "={{ $json.data.attributes.last_analysis_stats.harmless }}"
            },
            {
              "id": "72a776d5-70d7-4c30-b8fc-f7da382bc626",
              "name": "data.attributes.last_analysis_stats.timeout",
              "type": "number",
              "value": "={{ $json.data.attributes.last_analysis_stats.timeout }}"
            },
            {
              "id": "b85d8e8a-620c-4bb7-97db-d780f273deee",
              "name": "data.attributes.reputation",
              "type": "number",
              "value": "={{ $json.data.attributes.reputation }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "3d641c80-8a2a-4888-9ee3-ecd82f8d0d8b",
      "name": "Auto Issue Certificate Based on 0 Malicious Reports",
      "type": "n8n-nodes-base.if",
      "position": [
        2300,
        1840
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "795c6ff5-ac4a-4b67-b2fe-369fba276194",
              "operator": {
                "type": "number",
                "operation": "lte"
              },
              "leftValue": "={{ $json.data.attributes.last_analysis_stats.malicious }}",
              "rightValue": 0
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "3f6e9bf2-6c6c-4316-8d14-1b004122fa67",
      "name": "Auto Issue Certificate",
      "type": "n8n-nodes-base.noOp",
      "position": [
        2560,
        1700
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "fa34e736-65c4-4bc1-a391-794225a588d2",
      "name": "Generate Report For Manual Approval",
      "type": "n8n-nodes-base.noOp",
      "position": [
        2540,
        2220
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "178afe87-cdef-46f0-8166-68b661349189",
      "name": "Get Slack Team ID",
      "type": "n8n-nodes-base.set",
      "position": [
        1220,
        2220
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "53dfe019-d91d-4f5c-b279-f8b3fde98bf1",
              "name": "id",
              "type": "string",
              "value": "={{ $json.response.team.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "c4d89085-f7f4-4073-bfe2-cd156275710c",
      "name": "Execute Workflow",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        1520,
        2220
      ],
      "parameters": {
        "options": {},
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "ZIl9VdWh7BiVRRBT",
          "cachedResultName": "Slack Team ID to Name"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "51d85502-ea61-423b-a6c4-66ed8397d685",
      "name": "Merge User and Team Data",
      "type": "n8n-nodes-base.merge",
      "position": [
        1820,
        2140
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3
    },
    {
      "id": "febb1be8-7cad-46f1-a854-2ff1432216cb",
      "name": "OpenAI",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        2720,
        2220
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini",
          "cachedResultName": "GPT-4O-MINI"
        },
        "options": {},
        "messages": {
          "values": [
            {
              "content": "=Analyze the following VirusTotal scan results and summarize the overall risk as Low, Medium, or High based on the number of engines flagging the domain (excluding \"clean\" or \"unrated\" results). Use the following criteria for risk rating:\n\nLow: No significant threats detected; domain is clean.\nMedium: Minor issues detected; may require further review.\nHigh: Significant threats like phishing or malware; manual review recommended.\n\nHere are the scan results for the domain {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}:\n\nMalicious: {{ $json.data.attributes.last_analysis_stats.malicious }}\nSuspicious: {{ $json.data.attributes.last_analysis_stats.suspicious }}\nUndetected: {{ $json.data.attributes.last_analysis_stats.undetected }}\nHarmless: {{ $json.data.attributes.last_analysis_stats.harmless }}\nTimeout: {{ $json.data.attributes.last_analysis_stats.timeout }}\nReputation: {{ $json.data.attributes.reputation }}\n\nProvide an overall risk rating and suggest next steps based on your analysis. Please keep it concise. "
            },
            {
              "role": "system",
              "content": "Analyze the VirusTotal scan results and categorize the domainâ€™s risk as Low, Medium, or High:\n\nIdentify Risks: Focus on results flagged as anything other than \"clean\" or \"unrated.\"\nAssess Risk:\nLow: No major threats flagged, domain is safe.\nMedium: Minor issues flagged, review recommended.\nHigh: Significant threats flagged (e.g., phishing, malware), manual review needed.\nRecommendation:\nLow: Auto-issue the certificate.\nMedium/High: Recommend manual review."
            }
          ]
        }
      },
      "credentials": {
        "openAiApi": {
          "id": "2KVzlb0XZRZkoObj",
          "name": "angel openai auth"
        }
      },
      "typeVersion": 1.5
    },
    {
      "id": "04ffe7bb-be5d-4ce0-b17c-68276673f585",
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1160,
        1680
      ],
      "parameters": {
        "color": 7,
        "width": 833.9929589980072,
        "height": 705.5291769708515,
        "content": "![n8n](https://i.imgur.com/qXWqiOd.png)  \n## ë‹¤ë¥¸ ì›Œí¬í”Œë¡œìš° ë‚´ì—ì„œ ì›Œí¬í”Œë¡œìš°ë¥¼ í•¨ìˆ˜ì²˜ëŸ¼ ì‹¤í–‰  \n\nì´ ì›Œí¬í”Œë¡œìš° ì„¹ì…˜ì—ëŠ” Slack User IDë¥¼ ì´ë©”ì¼ê³¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” 2ê°œì˜ ì„œë¸Œì›Œí¬í”Œë¡œìš°ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, Slack Team IDë¥¼ íŒ€ ì´ë¦„ê³¼ ì•„ë°”íƒ€ë¡œ ë³€í™˜í•˜ì—¬ ìŠ¬ë™ ë©”ì‹œì§€ë¥¼ ë” ì‹œê°ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì´ëŸ¬í•œ í”Œë¡œìš°ë¥¼ ì½”ë“œì—ì„œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\nì´ëŸ¬í•œ ë…¸ë“œë“¤ì€ ì„œë¡œ ë³‘ë ¬ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ ê° ìŠ¤ë ˆë“œì—ì„œ ìƒì„±ëœ ë°ì´í„°ë¥¼ ë®ì–´ì“°ì§€ ì•Šìœ¼ë©°, ì´í›„ Merge ë…¸ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°í•©ë©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "a2b48f56-946b-4ae7-ade4-5b84b1a99bb9",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1160,
        1180
      ],
      "parameters": {
        "color": 7,
        "width": 832.2724669887743,
        "height": 485.55399396506067,
        "content": "VirusTotal  \n## VirusTotalì„ ì‚¬ìš©í•œ URL ë¶„ì„  \nì²« ë²ˆì§¸ ë…¸ë“œëŠ” Subscription Events APIë¥¼ í†µí•´ Slack APIë¡œë¶€í„° ëª¨ë“  ë©”ì‹œì§€ë¥¼ ë°›ìŠµë‹ˆë‹¤. Subscription Events API ì„¤ì •ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ë¥¼ [ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì—¬](https://api.slack.com/apis/connections/events-api) ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n  \në‘ ë²ˆì§¸ ë…¸ë“œëŠ” Slackìœ¼ë¡œë¶€í„° í˜ì´ë¡œë“œë¥¼ ì¶”ì¶œí•˜ì—¬ n8nì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ê°ì²´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "c38c30f3-acb1-40e4-acc5-3fd4f6b8e643",
      "name": "Merge Requestor and VT Data",
      "type": "n8n-nodes-base.merge",
      "position": [
        2100,
        1840
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3
    },
    {
      "id": "2e2c6100-b82e-4cdf-a290-33c2898de652",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2480,
        1420
      ],
      "parameters": {
        "color": 7,
        "width": 547.705272240834,
        "height": 485.55399396506067,
        "content": "ë°”ì´ëŸ¬ìŠ¤í† íƒˆ  \n## Venafië¥¼ í†µí•œ ìë™ CSR ìƒì„±  \nSlack ì‚¬ìš©ìì˜ ì›¹í›…ìœ¼ë¡œë¶€í„°ì˜ ë§¥ë½ ë°ì´í„°ê°€ í•„ìš”í•œ ë§¥ë½ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ ì†í•œ Slack íŒ€/ê·¸ë£¹ì˜ ì´ë¦„ê³¼ í•„ìš”í•œ ê²½ìš° ê·¸ë“¤ì˜ ì´ë©”ì¼ê³¼ ì´ë¦„ì„ í¬í•¨í•©ë‹ˆë‹¤.  \nìë™ CSR ìƒì„±ì´ ì‘ë™í•˜ë ¤ë©´, Vsateliteê°€ ë°°í¬ë˜ì–´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”."
      },
      "typeVersion": 1
    },
    {
      "id": "4c168cd6-e5d2-4d82-9fe3-3b8431db3dcd",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3040,
        1309.0359710471785
      ],
      "parameters": {
        "color": 7,
        "width": 367.3323860824746,
        "height": 831.2760849855022,
        "content": "![Imgur](https://i.imgur.com/iKyMV0N.png)  \n## ìŠ¬ë™ì— ë§¥ë½ì  ë©”ì‹œì§€ ë³´ë‚´ê¸°  \nì´ ì„¹ì…˜ì€ ëª¨ë‹¬ ì°½ì„ ì—´ì–´ TheHiveë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.  \n  \nëª¨ë‹¬ì€ ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ê²ƒë“¤ì€ ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë°”ì¼ì…ë‹ˆë‹¤! ì˜¤ë¥¸ìª½ì— ìŠ¬ë™ ëª¨ë‹¬ì˜ ìŠ¤í¬ë¦°ìƒ·ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n  \nìì„¸í•œ ë‚´ìš©ì€ [ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”](https://api.slack.com/surfaces/modals)"
      },
      "typeVersion": 1
    },
    {
      "id": "08687e15-90e0-42da-95a4-ada8b7ddcd36",
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2000,
        1421.1618229241317
      ],
      "parameters": {
        "color": 7,
        "width": 465.44793569024944,
        "height": 676.0664675646049,
        "content": "![n8n](https://i.imgur.com/lKnBNnH.png)  \n## n8nì„ ì‚¬ìš©í•œ íš¨ìœ¨ì ì¸ Slack ìƒí˜¸ì‘ìš© ì²˜ë¦¬  \n\nì´ ì›Œí¬í”Œë¡œì˜ ì„¹ì…˜ì€ íŠ¹ì • íŠ¸ë¦¬ê±°ì™€ ì¡°ê±´ì— ë”°ë¼ Slackì—ì„œ ì˜¤ëŠ” ë©”ì‹œì§€ì™€ ì œì¶œë¬¼ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ë¼ìš°íŒ…í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. Slack ìƒí˜¸ì‘ìš©ì´ ë°œìƒí•  ë•Œâ€”ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ìê°€ ì·¨ì•½ì  ìŠ¤ìº”ì„ íŠ¸ë¦¬ê±°í•˜ê±°ë‚˜ ëª¨ë‹¬ì„ í†µí•´ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°â€”ì›Œí¬í”Œë¡œê°€ ì§€ëŠ¥ì ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì ì ˆí•œ ì‘ì—…ìœ¼ë¡œ ë¼ìš°íŒ…í•©ë‹ˆë‹¤:  \n\n### Output"
      },
      "typeVersion": 1
    },
    {
      "id": "7098d247-5f39-4c61-a055-d7e9d12c2a64",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2480,
        1920
      ],
      "parameters": {
        "color": 7,
        "width": 544.2406462166426,
        "height": 546.0036529662652,
        "content": "AI ëª¨ë¸ ì‘ë‹µ íŒŒì‹±\n\nì´ ì›Œí¬í”Œë¡œëŠ” í˜„ì¬ OpenAIë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ AI Agent ë…¸ë“œë¥¼ ì•„ë˜ì—ì„œ êµì²´í•˜ê³  n8n ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ìì‹ ì˜ ë¡œì»¬ AI LLMì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "3f2ea251-6f4e-4701-8456-d3020169f802",
      "name": "Send Auto Generated Confirmation",
      "type": "n8n-nodes-base.slack",
      "position": [
        3160,
        1700
      ],
      "parameters": {
        "text": "test",
        "select": "channel",
        "blocksUi": "={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*:lock: CSR Auto-Issued Successfully!*\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\n*Requested by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\n*Email:* {{ $('Merge User and Team Data').item.json.email }}\\n*Date Issued:* {{ $json.creationDate }}\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"image\",\n\t\t\t\t\"image_url\": \"{{ $('Merge User and Team Data').item.json.team.icon.image_132 }}\",\n\t\t\t\t\"alt_text\": \"Team Avatar\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*CSR Details:*\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"fields\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Common Name:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Organization:* n8n.io\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Issued By:* Venafi CA\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"actions\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \"View CSR Details\"\n\t\t\t\t\t},\n\t\t\t\t\t\"url\": \"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\",\n\t\t\t\t\t\"style\": \"primary\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \"Revoke CSR\"\n\t\t\t\t\t},\n\t\t\t\t\t\"style\": \"danger\",\n\t\t\t\t\t\"value\": \"revoke_csr\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "C07MB8PGZ36"
        },
        "messageType": "block",
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "hkcQkp6qhtiMzBEX",
          "name": "certbot"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "17b7cc2e-32ff-4670-a756-bb41627dc14a",
      "name": "Send Message Request for Manual Approval",
      "type": "n8n-nodes-base.slack",
      "position": [
        3160,
        1940
      ],
      "parameters": {
        "text": "test",
        "select": "channel",
        "blocksUi": "={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \":warning: *CSR Pending Approval*\\n\\nThe Certificate Signing Request for the following domain was not auto-approved. Please review the details and press the button below to submit the request for manual approval.\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\n*Submitted by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\n*Requestor Email:* {{ $('Merge Requestor and VT Data').item.json.email }}\\n*Date Submitted:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }}\\n*Domain:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\\n\\n:mag: *AI Analysis*\\n> The AI detected the following potential issues with the CSR:\\n> - *VT Malicious Reports:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.last_analysis_stats.malicious }}\\n> - *Reputation Score:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.reputation }}/100\\n> - *Additional Notes:* {{ $json.message.content.replace(/\\n/g, '\\\\n').replace(/###/g, ' ').replace(/-\\s+\\*\\*(.*?)\\*\\*/g, 'â€¢ *$1*').replace(/\"/g, '\\\\\"').replace(/\\*\\*/g, '*') }}\\n\\nPlease ensure these risks are mitigated before proceeding.\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"image\",\n\t\t\t\t\"image_url\": \"https://avatars.slack-edge.com/2024-08-29/7652078599283_52acb3a88da26e76bab6_132.png\",\n\t\t\t\t\"alt_text\": \"Team Avatar\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"actions\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \":arrow_forward: Submit for Approval\"\n\t\t\t\t\t},\n\t\t\t\t\t\"value\": \"submit_for_approval\",\n\t\t\t\t\t\"style\": \"primary\",\n\t\t\t\t\t\"action_id\": \"submit_for_approval\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \"View CSR Details\"\n\t\t\t\t\t},\n\t\t\t\t\t\"value\": \"view_csr_details\",\n\t\t\t\t\t\"url\": \"https://google.com\",\n\t\t\t\t\t\"action_id\": \"view_csr_details\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"Submitted on {{ $now.toFormat('MMMM dd, yyyy') }}. The request requires manual approval. If you have any questions, contact the security team.\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "C07MB8PGZ36"
        },
        "messageType": "block",
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "hkcQkp6qhtiMzBEX",
          "name": "certbot"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "480c7f12-fc3a-44d1-885f-d6618a1e0dc8",
      "name": "Route Message",
      "type": "n8n-nodes-base.switch",
      "position": [
        620,
        1100
      ],
      "parameters": {
        "rules": {
          "values": [
            {
              "outputKey": "Request Modal",
              "conditions": {
                "options": {
                  "version": 1,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.response.callback_id }}",
                    "rightValue": "request-certificate"
                  }
                ]
              },
              "renameOutput": true
            },
            {
              "outputKey": "Submit Data",
              "conditions": {
                "options": {
                  "version": 1,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "65daa75f-2e17-4ba0-8fd8-2ac2159399e3",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.response.type }}",
                    "rightValue": "view_submission"
                  }
                ]
              },
              "renameOutput": true
            },
            {
              "outputKey": "Block Actions",
              "conditions": {
                "options": {
                  "version": 1,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "87f6f93e-28c9-49bc-8e1e-d073d86347b4",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.response.type }}",
                    "rightValue": "block_actions"
                  }
                ]
              },
              "renameOutput": true
            }
          ]
        },
        "options": {
          "fallbackOutput": "none"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "a42115ce-f0d7-443b-947d-cb8d54c2df22",
      "name": "Venafi TLS Protect Cloud1",
      "type": "n8n-nodes-base.venafiTlsProtectCloud",
      "position": [
        1500,
        2700
      ],
      "parameters": {
        "options": {},
        "commonName": "={{ $json.response.message.blocks[2].text.text.match(/\\*Domain:\\*\\s*<http[^|]+\\|([^\\n]+)>/)[1] }}",
        "generateCsr": true,
        "applicationId": "f3c15c80-7151-11ef-9a22-abeac49f7094",
        "additionalFields": {
          "organizationalUnits": [
            "={{ $json.response.message.blocks[2].text.text.match(/\\*Team:\\*\\s*([^\\n]*)/)[1] }}"
          ]
        },
        "certificateIssuingTemplateId": "d28d82b1-714b-11ef-9026-7bb80b32867a"
      },
      "credentials": {
        "venafiTlsProtectCloudApi": {
          "id": "WU38IpfutNNkJWuo",
          "name": "Venafi TLS Protect Cloud account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "69765a07-32ee-478a-a2f7-4de459fd69d9",
      "name": "Send Auto Generated Confirmation1",
      "type": "n8n-nodes-base.slack",
      "position": [
        1800,
        2700
      ],
      "parameters": {
        "text": "test",
        "select": "channel",
        "blocksUi": "={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*:lock: CSR Auto-Issued Successfully!*\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*Team:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\*Team:\\*\\s*([^\\n]*)/)[1] }}\\n*Requested by:* \\n*Email:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\*Requestor\\sEmail:\\*\\s*<mailto:([^|]+)\\|/)[1] }}\\n*Date Issued:* {{ $json.creationDate }}\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"image\",\n\t\t\t\t\"image_url\": \"{{ $('Parse Webhook').item.json.response.message.blocks[2].accessory.image_url }}\",\n\t\t\t\t\"alt_text\": \"Team Avatar\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"context\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*CSR Details:*\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"fields\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Common Name:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\*Domain:\\*\\s*<http[^|]+\\|([^\\n]+)>/)[1] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Organization:* n8n.io\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Issued By:* Venafi CA\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"actions\",\n\t\t\t\"elements\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \"View CSR Details\"\n\t\t\t\t\t},\n\t\t\t\t\t\"url\": \"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\",\n\t\t\t\t\t\"style\": \"primary\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"button\",\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\t\"text\": \"Revoke CSR\"\n\t\t\t\t\t},\n\t\t\t\t\t\"style\": \"danger\",\n\t\t\t\t\t\"value\": \"revoke_csr\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "C07MB8PGZ36"
        },
        "messageType": "block",
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "hkcQkp6qhtiMzBEX",
          "name": "certbot"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "82b70dab-2c29-4ecd-8a26-8d7c9e8c007f",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1165.4582041476783,
        2400
      ],
      "parameters": {
        "color": 7,
        "width": 822.2470680931556,
        "height": 485.55399396506067,
        "content": "![ë°”ì´ëŸ¬ìŠ¤í† íƒˆ](https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=250&width=250)  \n## Venafië¥¼ í†µí•œ ìˆ˜ë™ CSR ìƒì„±  \nSlack ì‚¬ìš©ìì˜ ì›¹í›…ìœ¼ë¡œë¶€í„°ì˜ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ê°€ í•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ ì†í•œ Slack íŒ€/ê·¸ë£¹ì˜ ì´ë¦„ê³¼ í•„ìš”í•œ ê²½ìš° ì‚¬ìš©ìì˜ ì´ë©”ì¼ê³¼ ì´ë¦„ì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ì„¹ì…˜ì€ ì•„ì§ ì»¨í…ìŠ¤íŠ¸ì˜ ì¦ëª… ë‹¨ê³„ì´ë©°, ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   \nìë™ CSR ìƒì„±ì´ ì‘ë™í•˜ë ¤ë©´, Vsateliteê°€ ë°°í¬ë˜ì–´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”."
      },
      "typeVersion": 1
    },
    {
      "id": "1ae279b2-fc2d-4686-a640-2592cc98318e",
      "name": "Manual Issue Certificate",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1240,
        2700
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "ce9c2a38-ef95-467d-846b-35f3aa6b2c84",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "position": [
        200,
        1100
      ],
      "webhookId": "4f86c00d-ceb4-4890-84c5-850f8e5dec05",
      "parameters": {
        "path": "venafiendpoint",
        "options": {},
        "httpMethod": "POST",
        "responseMode": "responseNode"
      },
      "typeVersion": 2
    },
    {
      "id": "1caa5c53-7b65-4578-a7ca-0bf62d05cfb0",
      "name": "Respond to webhook success",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        760,
        1280
      ],
      "parameters": {
        "options": {},
        "respondWith": "noData"
      },
      "typeVersion": 1.1
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI": {
      "main": [
        [
          {
            "node": "Send Message Request for Manual Approval",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Parse Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Webhook": {
      "main": [
        [
          {
            "node": "Route Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route Message": {
      "main": [
        [
          {
            "node": "Respond to Slack Webhook - Vulnerability",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Close Modal Popup",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond to webhook success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Fields": {
      "main": [
        [
          {
            "node": "VirusTotal HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Workflow": {
      "main": [
        [
          {
            "node": "Merge User and Team Data",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Close Modal Popup": {
      "main": [
        [
          {
            "node": "Extract Fields",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Slack User ID",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Slack Team ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Slack Team ID": {
      "main": [
        [
          {
            "node": "Execute Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Slack User ID": {
      "main": [
        [
          {
            "node": "Translate Slack User ID to Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Auto Issue Certificate": {
      "main": [
        [
          {
            "node": "Venafi TLS Protect Cloud",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VirusTotal HTTP Request": {
      "main": [
        [
          {
            "node": "Summarize output to save on tokens",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Manual Issue Certificate": {
      "main": [
        [
          {
            "node": "Venafi TLS Protect Cloud1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge User and Team Data": {
      "main": [
        [
          {
            "node": "Merge Requestor and VT Data",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Venafi TLS Protect Cloud": {
      "main": [
        [
          {
            "node": "Send Auto Generated Confirmation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Venafi TLS Protect Cloud1": {
      "main": [
        [
          {
            "node": "Send Auto Generated Confirmation1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to webhook success": {
      "main": [
        [
          {
            "node": "Manual Issue Certificate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Requestor and VT Data": {
      "main": [
        [
          {
            "node": "Auto Issue Certificate Based on 0 Malicious Reports",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Translate Slack User ID to Email": {
      "main": [
        [
          {
            "node": "Merge User and Team Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarize output to save on tokens": {
      "main": [
        [
          {
            "node": "Merge Requestor and VT Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Report For Manual Approval": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Slack Webhook - Vulnerability": {
      "main": [
        [
          {
            "node": "Venafi Request Certificate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Auto Issue Certificate Based on 0 Malicious Reports": {
      "main": [
        [
          {
            "node": "Auto Issue Certificate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Generate Report For Manual Approval",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}