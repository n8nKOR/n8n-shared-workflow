{
  "id": "xQHiKDTkezDY5lFu",
  "meta": {
    "instanceId": "03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8"
  },
  "name": "Suspicious_login_detection",
  "tags": [
    {
      "id": "GCHVocImoXoEVnzP",
      "name": "ğŸ› ï¸ In progress",
      "createdAt": "2023-10-31T02:17:21.618Z",
      "updatedAt": "2023-10-31T02:17:21.618Z"
    },
    {
      "id": "QPJKatvLSxxtrE8U",
      "name": "Secops",
      "createdAt": "2023-10-31T02:15:11.396Z",
      "updatedAt": "2023-10-31T02:15:11.396Z"
    },
    {
      "id": "hF4M6DtfFqOn2HK2",
      "name": "createdBy:Milorad",
      "createdAt": "2023-10-31T02:20:20.366Z",
      "updatedAt": "2023-10-31T02:20:20.366Z"
    }
  ],
  "nodes": [
    {
      "id": "a95e464a-7451-4737-9db8-993a6568595b",
      "name": "Extract relevant data",
      "type": "n8n-nodes-base.set",
      "position": [
        -260,
        700
      ],
      "parameters": {
        "values": {
          "string": [
            {
              "name": "ip",
              "value": "={{ $json.body.context.ip }}"
            },
            {
              "name": "userAgent",
              "value": "={{ $json.body.context.userAgent }}"
            },
            {
              "name": "timestamp",
              "value": "={{ $json.body.originalTimestamp }}"
            },
            {
              "name": "url",
              "value": "={{ $json.body.context.page.url }}"
            },
            {
              "name": "userId",
              "value": "={{ $json.body.userId }}"
            }
          ]
        },
        "options": {},
        "keepOnlySet": true
      },
      "typeVersion": 2
    },
    {
      "id": "d7dea680-14f3-4ffd-bfaf-f928b69d801d",
      "name": "New /login event",
      "type": "n8n-nodes-base.webhook",
      "disabled": true,
      "position": [
        -740,
        700
      ],
      "webhookId": "705ca4c4-0a38-4ef8-9de9-abc8b3686dc6",
      "parameters": {
        "path": "705ca4c4-0a38-4ef8-9de9-abc8b3686dc6",
        "options": {},
        "httpMethod": "POST"
      },
      "typeVersion": 1
    },
    {
      "id": "bd75aad9-2d24-4083-823d-bc789fb7ef07",
      "name": "Unknown threat?",
      "type": "n8n-nodes-base.if",
      "position": [
        720,
        1240
      ],
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.noise }}"
            },
            {
              "value1": "={{ $json.riot }}"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d0845980-3b8c-4659-95a1-82e925867f28",
      "name": "Get last 10 logins from the same user",
      "type": "n8n-nodes-base.postgres",
      "disabled": true,
      "position": [
        960,
        1220
      ],
      "parameters": {
        "query": "SELECT * FROM staging_n8n_cloud_frontend.user_signed_in WHERE user_id='{{ $('Extract relevant data').item.json.userId }}' ORDER BY received_at DESC LIMIT 10;",
        "options": {},
        "operation": "executeQuery"
      },
      "credentials": {
        "postgres": {
          "id": "aP9LLonHicGm2A7j",
          "name": "n8n product data"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "90e859b2-aa64-48e7-a8fe-696e3b7216f1",
      "name": "Query IP API1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1240,
        1340
      ],
      "parameters": {
        "url": "=http://ip-api.com/json/{{ $json.context_ip }}",
        "options": {}
      },
      "typeVersion": 4.1
    },
    {
      "id": "3a944973-132a-4272-97e3-42528eb4c0fc",
      "name": "New location?",
      "type": "n8n-nodes-base.if",
      "position": [
        1440,
        1340
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.city }}",
              "value2": "={{ $('Merge').item.json.city }}",
              "operation": "notEqual"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "fb4d5d07-58ae-4b17-a389-29e7fbe2caa2",
      "name": "Parse User Agent",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1260,
        1640
      ],
      "parameters": {
        "url": "https://api.userparser.com/1.1/detect",
        "options": {},
        "sendQuery": true,
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "queryParameters": {
          "parameters": [
            {
              "name": "ua",
              "value": "={{ $json.context_user_agent }}"
            }
          ]
        }
      },
      "credentials": {
        "httpQueryAuth": {
          "id": "33f1NrH1bLdXCGyw",
          "name": "n8n Userparser API Key"
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "56442924-914c-461d-b4d7-f08192e1b53b",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        295,
        1502
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combinationMode": "multiplex"
      },
      "typeVersion": 2.1
    },
    {
      "id": "2b36f782-029d-41de-8823-6c083f3c305a",
      "name": "New Device/Browser?",
      "type": "n8n-nodes-base.if",
      "position": [
        1460,
        1640
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.browser.name }}",
              "value2": "={{ $('Complete login info').first().json.browser.name }}",
              "operation": "notEqual"
            },
            {
              "value1": "={{ $json.operatingSystem.name }}",
              "value2": "={{ $('Complete login info').first().json.operatingSystem.name }}",
              "operation": "notEqual"
            },
            {
              "value1": "={{ $json.device.type }}",
              "value2": "={{ $('Complete login info').first().json.device.type }}",
              "operation": "notEqual"
            }
          ]
        },
        "combineOperation": "any"
      },
      "typeVersion": 1
    },
    {
      "id": "612c3704-6ea1-4978-ae84-17326f459c25",
      "name": "Complete login info",
      "type": "n8n-nodes-base.merge",
      "position": [
        540,
        1240
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combinationMode": "multiplex"
      },
      "typeVersion": 2.1
    },
    {
      "id": "9c097c31-a86d-45fe-92c7-14a58eae87b4",
      "name": "Query user by ID",
      "type": "n8n-nodes-base.postgres",
      "disabled": true,
      "position": [
        2020,
        1340
      ],
      "parameters": {
        "query": "SELECT * FROM staging_n8n_cloud_frontend.users WHERE id='{{ $('Extract relevant data').item.json.userId }}'",
        "options": {},
        "operation": "executeQuery"
      },
      "credentials": {
        "postgres": {
          "id": "aP9LLonHicGm2A7j",
          "name": "n8n product data"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "cd6fb55b-b8f6-4778-a62a-34be42e2660d",
      "name": "New Location",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1660,
        1280
      ],
      "parameters": {},
      "executeOnce": true,
      "typeVersion": 1
    },
    {
      "id": "7070a43a-d588-4bbb-b8d0-50e8eff171df",
      "name": "New Device/Browser",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1674,
        1625
      ],
      "parameters": {},
      "executeOnce": true,
      "typeVersion": 1
    },
    {
      "id": "dca6d5ed-d92f-49a6-9910-c9194e696e70",
      "name": "User has email?",
      "type": "n8n-nodes-base.if",
      "position": [
        2360,
        1360
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.email }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "14cd3d37-5c00-4750-8ad2-f78fce66019c",
      "name": "HTML",
      "type": "n8n-nodes-base.html",
      "position": [
        2580,
        1313
      ],
      "parameters": {
        "html": "<p>\n  Hello {{ $json.first_name || $json.username }},\n</p>\n<p>\n  We've detected a recent login to your n8n account from a new device or location. Here are the details:\n</p>\n<p>\n  <ul>\n    <li><b>Username:</b> {{ $json.username }}</li>\n    <li><b>Date & Time:</b> {{ $('Extract relevant data').item.json.timestamp }}</li>\n    <li><b>Location:</b> {{ $('Complete login info').item.json.city }}, {{ $('Complete login info').item.json.country }}</li>\n    <li><b>Device:</b> {{ $('Complete login info').item.json.operatingSystem.name }} ({{ $('Complete login info').item.json.device.type }})</li>\n  </ul>\n</p>\n<p>\n  If this was you, you can disregard this email. We just wanted to make sure it was you who logged in from a new device or location.\n</p>\n  If this wasn't you, we recommend resetting your password right away.\n</p>\n\n<style>\n  p {\n    font-family: sans-serif;\n  }\n</style>"
      },
      "typeVersion": 1
    },
    {
      "id": "e99f7779-9b84-4f8c-80a0-b34c3c9df5b4",
      "name": "Inform user",
      "type": "n8n-nodes-base.gmail",
      "disabled": true,
      "position": [
        2740,
        1313
      ],
      "parameters": {
        "sendTo": "={{ $('User has email?').item.json.email }}",
        "message": "={{ $json.html }}",
        "options": {},
        "subject": "Important: Usual Login Attempt Detected"
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "162",
          "name": "Gmail - milorad@n8n.io"
        }
      },
      "typeVersion": 2
    },
    {
      "id": "b280b287-7b20-4dcb-9c0a-a3e5c3a60771",
      "name": "noise?",
      "type": "n8n-nodes-base.if",
      "position": [
        340,
        220
      ],
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.noise }}",
              "value2": true
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "5be949da-f04a-44f9-9cf0-5e221f9d27e8",
      "name": "Slack",
      "type": "n8n-nodes-base.slack",
      "disabled": true,
      "position": [
        1560,
        500
      ],
      "parameters": {
        "text": "=Suspicious login attempt detected:\n  - Priority: {{ $json.priority }}\n  - User: {{ $('Extract relevant data').item.json[\"userId\"] }}\n  - IP: {{ $('Extract relevant data').item.json[\"ip\"] }}\n  - Timestamp: {{ $('Extract relevant data').item.json[\"timestamp\"] }}\n  - User Agent: {{ $('Extract relevant data').item.json[\"userAgent\"] }}\nGreyNoise report: https://viz.greynoise.io/ip/{{ $('Extract relevant data').item.json[\"ip\"] }}",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "mode": "name",
          "value": "#slack-message-test"
        },
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "114",
          "name": "n8n Slack"
        }
      },
      "typeVersion": 2
    },
    {
      "id": "241e492c-fb9a-4b93-bd76-4167cb67f212",
      "name": "Check trust level",
      "type": "n8n-nodes-base.switch",
      "position": [
        780,
        360
      ],
      "parameters": {
        "rules": {
          "rules": [
            {
              "output": 3,
              "value2": 1,
              "operation": "equal"
            },
            {
              "output": 2,
              "value2": 2,
              "operation": "equal"
            }
          ]
        },
        "value1": "={{ $json.trust_level }}",
        "fallbackOutput": 1
      },
      "typeVersion": 1
    },
    {
      "id": "f99741d0-161e-49c6-8e41-d61b080e977d",
      "name": "Check classification",
      "type": "n8n-nodes-base.switch",
      "position": [
        780,
        200
      ],
      "parameters": {
        "rules": {
          "rules": [
            {
              "value2": "malicious"
            },
            {
              "output": 2,
              "value2": "benign"
            },
            {
              "output": 1,
              "value2": "unknown"
            }
          ]
        },
        "value1": "={{ $json.classification }}",
        "dataType": "string"
      },
      "typeVersion": 1
    },
    {
      "id": "594857f6-713f-496e-8257-b74acf5d1282",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0.10300782209924364,
        -502.1236093865191
      ],
      "parameters": {
        "width": 1443.8164871528645,
        "height": 1185.151137495839,
        "content": "![ê·¸ë ˆì´ë…¸ì´ì¦ˆ](https://i.imgur.com/4vSwTkY.png)  \n## ğŸš¦ GreyNoise ë°ì´í„°ë¡œ ê³ ê¸‰ ìœ„í˜‘ ìš°ì„ ìˆœìœ„í™”\n\nì´ ì›Œí¬í”Œë¡œì˜ ì´ ì„¹ì…˜ì—ì„œ GreyNoise ë°ì´í„°ì˜ í†µí•©, íŠ¹íˆ `GreyNoise` ë…¸ë“œ,ëŠ” ìœ„í˜‘ ìš°ì„ ìˆœìœ„í™” í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì œí•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ ë…¸ë“œê°€ GreyNoiseì™€ ìƒí˜¸ì‘ìš©í•˜ì—¬ ê° ê²½ë³´ê°€ ê´€ë ¨ëœ IP ì£¼ì†Œì˜ ì„±ê²©ì— ë”°ë¼ ì ì ˆí•œ ì£¼ì˜ë¥¼ ë°›ë„ë¡ í•©ë‹ˆë‹¤.\n\n-   **ì¸ë°”ìš´ë“œ ìœ„í˜‘ì— ëŒ€í•œ GreyNoise ë¶„ì„:** `GreyNoise` ë…¸ë“œê°€ IP ì£¼ì†Œë¥¼ ì‹ë³„í•˜ë©´ GreyNoiseë¥¼ ì¿¼ë¦¬í•˜ë©°, NOISE ë° RIOT ë°ì´í„°ì…‹([ìì„¸í•œ ë‚´ìš©](https://docs.greynoise.io/docs/riot-data))ì„ ê³ ë ¤í•©ë‹ˆë‹¤. ì´ ë…¸ë“œì˜ ì‘ë‹µì´ í›„ì† ë‹¨ê³„ë¥¼ ì•ˆë‚´í•©ë‹ˆë‹¤:  \n    -   **ì•Œë ¤ì§€ì§€ ì•Šì€ IPì— ëŒ€í•œ ë†’ì€ ìš°ì„ ìˆœìœ„:** `Check trust level` ë° `Check classification` ë…¸ë“œê°€ ì—¬ê¸°ì— ì‘ë™í•©ë‹ˆë‹¤. GreyNoiseì— IPì— ëŒ€í•œ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ (noise:false, riot:false), `ğŸ”´ Priority: HIGH` ë…¸ë“œì—ì„œ ìš°ì„ ìˆœìœ„ê°€ ë†’ê²Œ ì„¤ì •ë©ë‹ˆë‹¤. ì´ëŠ” ì ì¬ì ì¸ í‘œì  ê³µê²©ì„ ë‚˜íƒ€ë‚´ë©°, ì¦‰ì‹œ ë¶„ì„ê°€ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.  \n    -   **ì¼ë°˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë‚®ìŒì—ì„œ ì¤‘ê°„ ìš°ì„ ìˆœìœ„:** ì¼ë°˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„œë¹„ìŠ¤ì˜ ì¼ë¶€ë¡œ ì‹ë³„ëœ IP(riot:true)ëŠ” ì‹ ë¢° ìˆ˜ì¤€ê³¼ ìš´ì˜ ìƒíƒœì— ë”°ë¼ `ğŸŸ¡ Priority: MEDIUM` ë° `ğŸŸ¢ Priority: LOW` ë…¸ë“œì—ì„œ ë‚®ìŒì—ì„œ ì¤‘ê°„ ìš°ì„ ìˆœìœ„ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤. ì´ëŠ” ì•…ì˜ì  í™œë™ì˜ ìœ„í—˜ì´ ë‚®ìŒì„ ë°˜ì˜í•©ë‹ˆë‹¤.  \n-   **ë¶„ë¥˜ ê¸°ë°˜ ìš°ì„ ìˆœìœ„í™”:** ì›Œí¬í”Œë¡œëŠ” `Check classification` ë…¸ë“œì—ì„œ GreyNoiseì˜ IP ë¶„ë¥˜(ì•…ì˜ì , ë¬´í•´, ì•Œë ¤ì§€ì§€ ì•ŠìŒ)ë¥¼ ê³ ë ¤í•©ë‹ˆë‹¤:  \n    -   **ì•…ì˜ì  IP:** ê¸°íšŒì ì´ì§€ë§Œ ì ì¬ì ìœ¼ë¡œ í•´ë¡œìš´ í™œë™ì„ ì œì•ˆí•˜ë©°, `ğŸ”´ Priority: HIGH` ë…¸ë“œì—ì„œ ì¤‘ê°„ì—ì„œ ë†’ì€ ìš°ì„ ìˆœìœ„ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.  \n    -   **ë¬´í•´ IP:** ì¼ë°˜ì ìœ¼ë¡œ ì•Œë ¤ì§„ í–‰ìœ„ìì— ì˜í•œ ë¬´í•´í•œ ìŠ¤ìº”ì´ë¯€ë¡œ, `ğŸŸ¢ Priority: LOW` ë…¸ë“œì—ì„œ ë‚®ì€ ìš°ì„ ìˆœìœ„ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.  \n    -   **ì•Œë ¤ì§€ì§€ ì•Šì€ IP:** ì•„ë§ˆë„ ë¬´í•´í•˜ì§€ë§Œ í™•ì¸ë˜ì§€ ì•Šì€ í™œë™ì„ ë‚˜íƒ€ë‚´ì–´, `ğŸŸ¡ Priority: MEDIUM` ë…¸ë“œì—ì„œ ë‚®ìŒì—ì„œ ì¤‘ê°„ ìš°ì„ ìˆœìœ„ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.  \n-   **ì•„ì›ƒë°”ìš´ë“œ ìœ„í˜‘ì— ëŒ€í•œ ì¶”ê°€ ë§¥ë½:** ì•„ì›ƒë°”ìš´ë“œ ì—°ê²°ì˜ ê²½ìš°, ì›Œí¬í”Œë¡œëŠ” `GreyNoise` ë…¸ë“œê°€ í•´ì„í•œ ë°”ì— ë”°ë¼ IPê°€ ì•Œë ¤ì§„ ì„œë¹„ìŠ¤ ì œê³µì ë˜ëŠ” ì•Œë ¤ì§„ ì¥ì¹˜ ìŠ¤ìºë‹ì¸ì§€ì— ê¸°ë°˜í•˜ì—¬ ê²½ë³´ë¥¼ ìš°ì„ ìˆœìœ„í™”í•©ë‹ˆë‹¤. ìŠ¤ìºë‹ ì¥ì¹˜ì— ëŒ€í•œ ì•„ì›ƒë°”ìš´ë“œ ì—°ê²°ì€ `ğŸ”´ Priority: HIGH` ë…¸ë“œì—ì„œ ë†’ì€ ìš°ì„ ìˆœìœ„ê°€ ë¶€ì—¬ë˜ì–´, ì ì¬ì ìœ¼ë¡œ ì›ì¹˜ ì•ŠëŠ” í–‰ë™ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\nì´ ì ‘ê·¼ ë°©ì‹ì€ GreyNoiseì˜ ê³ ê¸‰ ë°ì´í„° ë¶„ì„ì„ í™œìš©í•˜ì—¬ n8nì˜ ì •êµí•œ ì‚¬ì´ë²„ ë³´ì•ˆ ì†”ë£¨ì…˜ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ ì§€ëŠ¥í˜• ìš°ì„ ìˆœìœ„í™” ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•©í•˜ì—¬ ì›Œí¬í”Œë¡œëŠ” ë³´ì•ˆ íŒ€ì´ ê°€ì¥ ì‹œê¸‰í•œ ìœ„í˜‘ì— ë¨¼ì € ì§‘ì¤‘í•˜ë„ë¡ í•˜ì—¬ ì „ì²´ ë³´ì•ˆ ìì„¸ë¥¼ ê°•í™”í•©ë‹ˆë‹¤.\n\n### ì¸ì¦ - ë¬´ë£Œ í‹°ì–´ ì—†ìŒ\n\nGreyNoiseì˜ API í‚¤ë¥¼ ì„¤ì •í•˜ë ¤ë©´ `GreyNoise` ë…¸ë“œë¥¼ ì—´ê³  ìƒˆ ì¸ì¦ ìê²©ì¦ëª…ì„ ì¶”ê°€í•©ë‹ˆë‹¤. `Generic Credential Type`ì„ ì„ íƒí•œ ë‹¤ìŒ `Header Auth`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ `Credential for Header Auth`ì—ì„œ ì´ë¦„ì„ `key`ë¡œ, ê°’ì„ ìì‹ ì˜ `api key`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "ee90c638-882d-4a2e-8164-adaf4ec386be",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1450.4432083435722,
        -139
      ],
      "parameters": {
        "width": 560.0194854548777,
        "height": 818.6128004838087,
        "content": "## ğŸ“¢ Slack ì•Œë¦¼ ì „íŒŒ\n\n`Slack` ë…¸ë“œëŠ” ê²½ê³  í†µì‹ ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ìœ„í˜‘ì´ ì‹ë³„ë˜ê³  ìš°ì„ ìˆœìœ„ê°€ ë§¤ê²¨ì§€ë©´, ê´€ë ¨ ì •ë³´ë¥¼ ì‹ ì†í•˜ê²Œ Slackì„ í†µí•´ ë³´ì•ˆ íŒ€ì— ì „íŒŒí•©ë‹ˆë‹¤.\n\n- **ì‹œì˜ì ì ˆí•œ ê²½ê³  ì•Œë¦¼:** `Slack` ë…¸ë“œëŠ” ì§€ì •ëœ Slack ì±„ë„ë¡œ ìì„¸í•œ ê²½ê³ ë¥¼ ë³´ë‚´ë„ë¡ êµ¬ì„±ë©ë‹ˆë‹¤. ì´ ê²½ê³ ì—ëŠ” ìš°ì„ ìˆœìœ„ ìˆ˜ì¤€, ì‚¬ìš©ì ID, IP ì£¼ì†Œ, íƒ€ì„ìŠ¤íƒ¬í”„, ê·¸ë¦¬ê³  ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸ ì‹œë„ì˜ ì‚¬ìš©ì ì—ì´ì „íŠ¸ì™€ ê°™ì€ ì¤‘ìš”í•œ ì •ë³´ê°€ í¬í•¨ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íŒ€ì´ ì ì¬ì  ìœ„í˜‘ì— ëŒ€í•´ ì¦‰ì‹œ í†µë³´ë¥¼ ë°›ì„ ìˆ˜ ìˆì–´, ìœ„í—˜ì„ ì‹ ì†í•˜ê²Œ ì™„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- **ì´ì „ ë…¸ë“œì˜ ë°ì´í„° í†µí•©:** ì´ ë…¸ë“œëŠ” `Extract relevant data`ì™€ ê°™ì€ ì´ì „ ë…¸ë“œì—ì„œ ì¶”ì¶œ ë° ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•©ë‹ˆë‹¤. ì´ ìƒì„¸í•œ ì •ë³´ë¥¼ í†µí•´ Slack ë©”ì‹œì§€ê°€ í’ë¶€í•´ì§€ë©°, ìœ„í˜‘ì— ëŒ€í•œ í¬ê´„ì ì¸ ê°œìš”ë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n- **GreyNoise ë¶„ì„ ì§ì ‘ ë§í¬:** ë˜í•œ, Slack ë©”ì‹œì§€ì—ëŠ” í•´ë‹¹ IPì— ëŒ€í•œ GreyNoise ì‹œê°í™”ì— ëŒ€í•œ ì§ì ‘ ë§í¬ê°€ í¬í•¨ë©ë‹ˆë‹¤. ì´ ë§í¬ëŠ” `Extract relevant data` ë…¸ë“œì˜ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ë©°, íŒ€ êµ¬ì„±ì›ì´ IPì— ëŒ€í•œ ì‹¬ì¸µ ì •ë³´ë¥¼ ë¹ ë¥´ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬, ë” ë¹ ë¥´ê³  ì •ë³´ì— ê¸°ë°˜í•œ ëŒ€ì‘ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\n\nì´ ì ‘ê·¼ ë°©ì‹ì€ n8nì´ Slackê³¼ ê°™ì€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë„êµ¬ì™€ ì›í™œí•˜ê²Œ í†µí•©ë˜ëŠ” ëŠ¥ë ¥ì„ ë³´ì—¬ì£¼ë©°, ì‚¬ì´ë²„ ë³´ì•ˆ íŒ€ì´ í•­ìƒ ìœ„í˜‘ì— ëŒ€í•´ í†µë³´ë¥¼ ë°›ê³  íš¨ìœ¨ì ìœ¼ë¡œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "b617da5f-f7e0-4c6d-8080-c1d4b2e2ed53",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        477,
        690
      ],
      "parameters": {
        "width": 696.8700988949365,
        "height": 894.3487921624444,
        "content": "## ğŸ”„  í¬ê´„ì  ë¶„ì„ì„ ìœ„í•œ ë°ì´í„° í•©ì„±  \n`Complete login info` ë…¸ë“œëŠ” ì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ê° ë¡œê·¸ì¸ ì‹œë„ì— ëŒ€í•œ ìƒì„¸í•œ ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” ì¤‘ìš”í•œ ì—°ê²° ì§€ì  ì—­í• ì„ í•©ë‹ˆë‹¤.  \n\n-   **ë‹¤ì–‘í•œ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ê²°í•©:** `Complete login info` ë…¸ë“œëŠ” `GreyNoise`, `IP API`, ë° `UserParser` ë…¸ë“œì˜ ì •ë³´ë¥¼ ë³‘í•©í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ GreyNoiseì˜ ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤, IP-APIì˜ ì§€ë¦¬ì  ìœ„ì¹˜ ì„¸ë¶€ ì •ë³´, UserParserì˜ ì‚¬ìš©ì ì—ì´ì „íŠ¸ ì •ë³´ë¥¼ ê²°í•©í•˜ì—¬ í¬ê´„ì ì¸ ë°ì´í„°ì…‹ì„ ìƒì„±í•©ë‹ˆë‹¤.  \n-   **ë³´ì•ˆ ë¶„ì„ì„ ìœ„í•œ ê°•í™”ëœ ë§¥ë½:** ì´ ë‹¤ì–‘í•œ ì†ŒìŠ¤ì˜ ë°ì´í„°ë¥¼ ìœµí•©í•˜ì—¬ ì›Œí¬í”Œë¡œìš°ëŠ” ê° ë¡œê·¸ì¸ ì‹œë„ì— ëŒ€í•œ ë‹¤ê°ì ì¸ ê´€ì ì„ ì–»ìŠµë‹ˆë‹¤. ì´ ê°•í™”ëœ ë§¥ë½ì€ ì ì¬ì  ë³´ì•ˆ ìœ„í˜‘ì„ ë” ë†’ì€ ì •í™•ë„ë¡œ ì‹ë³„í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.  \n-   **íš¨ìœ¨ì ì¸ ì›Œí¬í”Œë¡œìš° êµ¬ì¡°:** ì´ ë‹¤ì–‘í•œ ë°ì´í„° í¬ì¸íŠ¸ì˜ í†µí•©ì€ n8nì˜ ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬ íš¨ìœ¨ì„±ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì—¬ëŸ¬ ì •ë³´ ìŠ¤íŠ¸ë¦¼ì„ í•˜ë‚˜ì˜ ë…¸ë“œë¡œ ëª¨ìœ¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì›Œí¬í”Œë¡œìš°ëŠ” ë¶„ì„ ë‹¨ê³„ì—ì„œ ëª¨ë“  ê´€ë ¨ ë°ì´í„°ë¥¼ ë™ì‹œì— ê³ ë ¤í•©ë‹ˆë‹¤.  \n-   **í›„ì† ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ì•ˆë‚´:** `Complete login info` ë…¸ë“œê°€ ì¤€ë¹„í•œ ë°ì´í„°ì…‹ì€ ì›Œí¬í”Œë¡œìš°ì˜ í›„ì† ë‹¨ê³„ë¥¼ ìœ„í•œ ê¸°ë°˜ì„ ë§ˆë ¨í•©ë‹ˆë‹¤. ì´ëŠ” `Unknown threat?` ë° `Get last 10 logins from the same user`ì™€ ê°™ì€ í›„ì† ë…¸ë“œê°€ ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì˜ ì „ì²´ì ì¸ ê´€ì ì— ê¸°ë°˜í•œ ì •ë³´ì— ì…ê°í•œ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë§¥ë½ì„ ì œê³µí•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "1e106297-b7db-4b2d-b08c-a35880782c8c",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1185,
        691
      ],
      "parameters": {
        "width": 663.6738255654103,
        "height": 892.4220900613532,
        "content": "## ğŸ“ ë¡œê·¸ì¸ ìœ„ì¹˜ ì´ìƒ ê°ì§€\n\n`Get last 10 logins from the same user` ë…¸ë“œë¥¼ ë”°ë¥´ëŠ” ë…¸ë“œë“¤ì€ ë¡œê·¸ì¸ ìœ„ì¹˜ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ì´ìƒì„ ì‹ë³„í•˜ëŠ” ë° ì „ë…í•©ë‹ˆë‹¤.\n\n- **ì—­ì‚¬ì  ë¡œê·¸ì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°:** `Get last 10 logins from the same user` ë…¸ë“œëŠ” Postgres ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¿¼ë¦¬í•˜ì—¬ ì‚¬ìš©ìì˜ ë§ˆì§€ë§‰ 10íšŒ ë¡œê·¸ì¸ ê¸°ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ë°ì´í„°ëŠ” ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ ìœ„ì¹˜ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ê¸°ì¤€ì´ ë©ë‹ˆë‹¤.\n\n- **í˜„ì¬ ë° ì—­ì‚¬ì  ì§€ë¦¬ì  ìœ„ì¹˜ ë°ì´í„° ë¹„êµ:** `Query IP API1` ë…¸ë“œëŠ” í˜„ì¬ ë¡œê·¸ì¸ ì‹œë„ì˜ ì§€ë¦¬ì  ìœ„ì¹˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ë°ì´í„°ëŠ” `New location?` ë…¸ë“œì—ì„œ ì—­ì‚¬ì  ë¡œê·¸ì¸ ìœ„ì¹˜ì™€ ë¹„êµë©ë‹ˆë‹¤.\n\n- **ìœ„ì¹˜ ì´ìƒ ì‹ë³„:** `New location?` ë…¸ë“œëŠ” í˜„ì¬ ë¡œê·¸ì¸ ì‹œì˜ ë„ì‹œê°€ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ì—­ì‚¬ì— ìˆëŠ” ë„ì‹œì™€ ë‹¤ë¥´ì§€ ì•Šì€ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ ë¹„êµëŠ” ìƒˆë¡œìš´, ì ì¬ì ìœ¼ë¡œ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ìœ„ì¹˜ì—ì„œì˜ ë¡œê·¸ì¸ê³¼ ê°™ì€ ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ íŒ¨í„´ì„ ê°ì§€í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.\n\n- **ìœ„ì¹˜ ì¼ê´€ì„± ê¸°ë°˜ ë¼ìš°íŒ…:** í˜„ì¬ ë¡œê·¸ì¸ ìœ„ì¹˜ê°€ ì—­ì‚¬ì  íŒ¨í„´ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ì— ë”°ë¼ ì›Œí¬í”Œë¡œëŠ” `New Location` ë˜ëŠ” `Known Location` ë…¸ë“œë¡œ ë¶„ê¸°ë©ë‹ˆë‹¤. `New Location` ë…¸ë“œëŠ” ìƒˆë¡œìš´ ë„ì‹œì—ì„œì˜ ë¡œê·¸ì¸ì´ ê°ì§€ë  ë•Œ í™œì„±í™”ë˜ì–´ ì ì¬ì ì¸ ë³´ì•ˆ ìœ„í—˜ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ, `Known Location` ë…¸ë“œëŠ” ë¡œê·¸ì¸ ìœ„ì¹˜ê°€ ì—­ì‚¬ì  ë°ì´í„°ì™€ ì¼ì¹˜í•  ë•Œ í™œì„±í™”ë˜ì–´ ì¼ë°˜ì ì¸ ë¡œê·¸ì¸ íŒ¨í„´ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "3e091a54-2fdc-491c-a168-0fb4fb704fd8",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2310.5877845770297,
        691.4637444823477
      ],
      "parameters": {
        "width": 629.1148167417672,
        "height": 841.097003209987,
        "content": "## ğŸ“§ ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ ì‹œë„ì— ëŒ€í•œ ì‚¬ìš©ì ì•Œë¦¼\n\n\"Suspicious Login Detection\" ì›Œí¬í”Œë¡œì˜ ìµœì¢… ì„¹ì…˜ì—ì„œ `User has email?`, `HTML`, ê·¸ë¦¬ê³  `Inform user` ë…¸ë“œê°€ í•¨ê»˜ ì‘ë™í•˜ì—¬ ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ ì‹œë„ë¥¼ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ìœ¼ë¡œì¨ ì‹œìŠ¤í…œì˜ ë³´ì•ˆê³¼ ì‘ë‹µì„±ì„ ê°•í™”í•©ë‹ˆë‹¤.\n\n- **ì´ë©”ì¼ ê°€ìš©ì„± í™•ì¸:** `Query user by ID`ë¡œ ì‚¬ìš©ì ì„¸ë¶€ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ í›„, `User has email?` ë…¸ë“œê°€ ì‚¬ìš©ìê°€ ê¸°ë¡ëœ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ í™•ì¸ì€ ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê°€ì§„ ì‚¬ìš©ìì—ê²Œë§Œ ì•Œë¦¼ í”„ë¡œì„¸ìŠ¤ê°€ ì§„í–‰ë˜ë„ë¡ ë³´ì¥í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.\n\n- **ì•Œë¦¼ ë©”ì‹œì§€ ì‘ì„±:** `HTML` ë…¸ë“œê°€ ì´ë©”ì¼ ì½˜í…ì¸ ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ ë…¸ë“œëŠ” ìƒˆë¡œìš´ ê¸°ê¸°ë‚˜ ìœ„ì¹˜ì—ì„œì˜ ìµœê·¼ ë¡œê·¸ì¸ì„ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¬ëŠ” ì˜ êµ¬ì„±ëœ HTML ë©”ì‹œì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë©”ì‹œì§€ì—ëŠ” ì‚¬ìš©ì ì´ë¦„, íƒ€ì„ìŠ¤íƒ¬í”„, ìœ„ì¹˜, ê·¸ë¦¬ê³  ê¸°ê¸° ì •ë³´ì™€ ê°™ì€ ì„¸ë¶€ ì‚¬í•­ì´ í¬í•¨ë˜ì–´ ë¡œê·¸ì¸ í™œë™ì— ëŒ€í•œ êµ¬ì²´ì ì¸ í†µì°°ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n- **ì´ë©”ì¼ ì•Œë¦¼ ë³´ë‚´ê¸°:** ë§ˆì§€ë§‰ìœ¼ë¡œ, `Inform user` ë…¸ë“œê°€ ì´ë©”ì¼ ì•Œë¦¼ì„ ë³´ëƒ…ë‹ˆë‹¤. ì´ ë…¸ë“œëŠ” ì´ì „ ë‹¨ê³„ì—ì„œ ì–»ì€ ì‚¬ìš©ì ì´ë©”ì¼ ì£¼ì†Œë¡œ `HTML` ë…¸ë“œê°€ ì‘ì„±í•œ ë©”ì‹œì§€ë¥¼ Gmailì„ í†µí•´ ë°œì†¡í•©ë‹ˆë‹¤.\n\n- **ì‚¬ìš©ì ì¸ì‹ ë° ë³´ì•ˆ ê°•í™”:** ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ í™œë™ì„ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ìœ¼ë¡œì¨ ì›Œí¬í”Œë¡œëŠ” ë³´ì•ˆì„ ê°•í™”í•  ë¿ë§Œ ì•„ë‹ˆë¼, ë¡œê·¸ì¸ì´ ìŠ¹ì¸ë˜ì§€ ì•Šì€ ê²½ìš° ì¦‰ì‹œ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆë„ë¡ ì‚¬ìš©ìì—ê²Œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ì´ëŠ” ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ë‚˜ ë³´ì•ˆ íŒ€ ì—°ë½ê³¼ ê°™ì€ ë‹¨ê³„ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "f9c6f726-ce2f-448b-a392-b86e0507ce13",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1858,
        691.3527917931716
      ],
      "parameters": {
        "width": 442.82773054232473,
        "height": 839.4355618292594,
        "content": "## ğŸ§© ì‚¬ìš©ì ì„¸ë¶€ ì •ë³´ ì¡°íšŒë¥¼ ìœ„í•œ í–¥ìƒëœ ì»¨í…ìŠ¤íŠ¸\n\n`Query user by ID` ë…¸ë“œëŠ” ë³´ì•ˆ ë¶„ì„ì„ ìœ„í•œ í–¥ìƒëœ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ ì‚¬ìš©ì íŠ¹ì • ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.\n\n-   **ì‚¬ìš©ì ì •ë³´ ê²€ìƒ‰:** `Query user by ID` ë…¸ë“œëŠ” í˜„ì¬ ë¡œê·¸ì¸ ì‹œë„ì™€ ì—°ê´€ëœ ì‚¬ìš©ì IDì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ Postgres ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•©ë‹ˆë‹¤. ì´ ì •ë³´ëŠ” ì‚¬ìš©ìì˜ í”„ë¡œí•„ê³¼ ì ‘ê·¼ íŒ¨í„´ì„ ì´í•´í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n\n-   **ìœ„ì¹˜ ë° ì¥ì¹˜ ë¶„ì„ í†µí•©:** ì´ ë…¸ë“œëŠ” `New Location` ë˜ëŠ” `New Device/Browser` ë…¸ë“œì˜ ê²½ê³  í›„ì— íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ê³ ëŠ” í˜„ì¬ ë¡œê·¸ì¸ ì‹œë„ê°€ ìƒˆë¡œìš´ ìœ„ì¹˜ë‚˜ ì¥ì¹˜/ë¸Œë¼ìš°ì € ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ì ì¬ì ìœ¼ë¡œ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n-   **ë³´ì•ˆ í†µì°°ë ¥ ê°•í™”:** ì‚¬ìš©ìì˜ ìì„¸í•œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ ì›Œí¬í”Œë¡œëŠ” ì‚¬ìš©ìì˜ ì •ìƒì ì¸ ì ‘ê·¼ íŒ¨í„´ê³¼ í”„ë¡œí•„ì— ëŒ€í•œ ë” ê¹Šì€ ì´í•´ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì´ ì •ë³´ëŠ” í•©ë²•ì ì¸ ì‚¬ìš©ì í–‰ë™ê³¼ ì ì¬ì ì¸ ë¬´ë‹¨ ì ‘ê·¼ì„ êµ¬ë¶„í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "6fd1a35c-5abc-4655-b5b5-836b49129d24",
      "name": "riot?",
      "type": "n8n-nodes-base.if",
      "position": [
        520,
        380
      ],
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $('GreyNoise').item.json.riot }}",
              "value2": true
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "123fa821-4eb0-42b9-99c9-a0157f7ffac8",
      "name": "ğŸ”´ Priority: HIGH",
      "type": "n8n-nodes-base.set",
      "position": [
        1180,
        220
      ],
      "parameters": {
        "values": {
          "string": [
            {
              "name": "priority",
              "value": "ğŸ”´ High"
            }
          ]
        },
        "options": {},
        "keepOnlySet": true
      },
      "typeVersion": 2
    },
    {
      "id": "459d0152-8184-4031-8f70-6c100f2bc6c3",
      "name": "ğŸŸ¡ Priority: MEDIUM",
      "type": "n8n-nodes-base.set",
      "position": [
        1180,
        360
      ],
      "parameters": {
        "values": {
          "string": [
            {
              "name": "priority",
              "value": "ğŸŸ¡ Medium"
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 2
    },
    {
      "id": "58427db9-8ef7-4916-8564-727bd587401d",
      "name": "ğŸŸ¢ Priority: LOW",
      "type": "n8n-nodes-base.set",
      "position": [
        1180,
        500
      ],
      "parameters": {
        "values": {
          "string": [
            {
              "name": "priority",
              "value": "ğŸŸ¢ Low"
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 2
    },
    {
      "id": "fd1e93a2-267e-4d5e-9724-6a4bb46b94b2",
      "name": "GreyNoise",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        280,
        440
      ],
      "parameters": {
        "url": "=https://api.greynoise.io/v3/community/{{ $json.ip }}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          }
        },
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "wwwfQfxzoBK7NH2a",
          "name": "n8n greynoise api key"
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "032b9558-a19b-4790-8593-8949ab2606d4",
      "name": "IP API",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        40,
        1280
      ],
      "parameters": {
        "url": "=http://ip-api.com/json/{{ $json.ip }}",
        "options": {}
      },
      "typeVersion": 4.1
    },
    {
      "id": "6cff0db9-27c3-4c4b-9af0-e8a8d55ad107",
      "name": "UserParser",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        80,
        1522
      ],
      "parameters": {
        "url": "https://api.userparser.com/1.1/detect",
        "options": {},
        "sendQuery": true,
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "queryParameters": {
          "parameters": [
            {
              "name": "ua",
              "value": "={{ $json.userAgent }}"
            }
          ]
        }
      },
      "credentials": {
        "httpQueryAuth": {
          "id": "33f1NrH1bLdXCGyw",
          "name": "n8n Userparser API Key"
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "65c7a039-5257-495d-86c2-18a44627ebe1",
      "name": "When clicking \"Execute Workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -740,
        880
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "a038a10a-baaf-4649-9d38-4fa661dfc4ce",
      "name": "Example event",
      "type": "n8n-nodes-base.code",
      "position": [
        -480,
        880
      ],
      "parameters": {
        "jsCode": "return {\n  json:\n  {\n    \"headers\": {\n      \"host\": \"internal.users.n8n.cloud\",\n      \"user-agent\": \"PostmanRuntime/7.32.3\",\n      \"content-length\": \"857\",\n      \"accept\": \"*/*\",\n      \"accept-encoding\": \"gzip, deflate, br\",\n      \"content-type\": \"application/json\",\n      \"postman-token\": \"e10e747f-0668-4238-9a3d-148b2c8591da\",\n      \"x-forwarded-for\": \"10.255.0.2\",\n      \"x-forwarded-host\": \"internal.users.n8n.cloud\",\n      \"x-forwarded-port\": \"443\",\n      \"x-forwarded-proto\": \"https\",\n      \"x-forwarded-server\": \"e591fa1c2d01\",\n      \"x-real-ip\": \"10.255.0.2\"\n    },\n    \"params\": {},\n    \"query\": {},\n    \"body\": {\n      \"anonymousId\": \"b4191c58-7d64-4c93-8bb4-479c3c95d283\",\n      \"context\": {\n        \"ip\": \"2.204.248.108\",\n        \"library\": {\n          \"name\": \"analytics.js\",\n          \"version\": \"next-1.53.0\"\n        },\n        \"locale\": \"en-US\",\n        \"page\": {\n          \"path\": \"/login\",\n          \"referrer\": \"https://github.com/\",\n          \"search\": \"\",\n          \"title\": \"n8n.cloud\",\n          \"url\": \"https://stage-app.n8n.cloud/login\"\n        },\n        \"userAgent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0\"\n      },\n      \"event\": \"User signed in\",\n      \"integrations\": {},\n      \"messageId\": \"ajs-next-a14f5b6e9860c7318a27f1ac05b3182d\",\n      \"originalTimestamp\": \"2023-06-28T11:26:46.302Z\",\n      \"properties\": {},\n      \"receivedAt\": \"2023-06-28T11:26:46.550Z\",\n      \"sentAt\": \"2023-06-28T11:26:46.313Z\",\n      \"timestamp\": \"2023-06-28T11:26:46.539Z\",\n      \"type\": \"track\",\n      \"userId\": \"staging-2055\"\n    }\n  }\n}"
      },
      "typeVersion": 2
    },
    {
      "id": "700a08d8-09ce-486c-bcfb-07d15f268d08",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -803,
        -83
      ],
      "parameters": {
        "width": 794.5711626683587,
        "height": 1175.5321499586535,
        "content": "![ì›¹í›…](https://i.imgur.com/D6SP9P0.png)  \n## ì›Œí¬í”Œë¡œìš° ê°œìš”\n\nn8nì˜ `Suspicious Login Detection` ì›Œí¬í”Œë¡œìš°ë¡œ í–¥ìƒëœ ì‚¬ì´ë²„ ë³´ì•ˆì„ ê²½í—˜í•˜ì„¸ìš”. ì´ëŠ” ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ê³¼ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸ í™œë™ì— ëŒ€í•œ ì‹ ì†í•œ ëŒ€ì‘ì„ ìœ„í•œ ìµœì ì˜ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤. ì´ ì›Œí¬í”Œë¡œìš°ëŠ” í…ŒìŠ¤íŠ¸ ë° ìš´ì˜ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ìˆ˜ë™ ë° ìë™ ì›¹í›… íŠ¸ë¦¬ê±°ë¥¼ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.\n\nì´ [GreyNoise ê°€ì´ë“œ](https://docs.greynoise.io/docs/applying-greynoise-data-to-your-analysis)ëŠ” ì´ ì›Œí¬í”Œë¡œìš°ì˜ ì•„í‚¤í…í„°ë¥¼ ì„¤ê³„í•˜ëŠ” ë° ì‚¬ìš©ë˜ì—ˆìœ¼ë©°, ì´ ì›Œí¬í”Œë¡œìš°ì˜ ìì²´ ë²„ì „ì„ ë§Œë“œëŠ” ë° ìœ ìš©í•œ ê°€ì´ë“œ ì—­í• ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì£¼ìš” ê¸°ëŠ¥:\n\n- ë°ì´í„° ì¶”ì¶œ: ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì—ì„œ IP ì£¼ì†Œì™€ ì‚¬ìš©ì IDì™€ ê°™ì€ ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ ì›í™œí•˜ê²Œ ì¶”ì¶œí•©ë‹ˆë‹¤.\n- ì‚¼ì¤‘ ìœ„í˜‘ ë¶„ì„: IP ì‹ ë¢° í‰ê°€ë¥¼ ìœ„í•œ `GreyNoise`, ìœ„ì¹˜ ì •ë³´ í†µì°°ì„ ìœ„í•œ `IP-API`, ì‚¬ìš©ì ì—ì´ì „íŠ¸ ì„¸ë¶€ ì‚¬í•­ì„ ìœ„í•œ `UserParser`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ ê°€ì§€ ê²½ë¡œë¡œ ë¶„í• í•˜ì—¬ ì² ì €íˆ ê²€í† í•©ë‹ˆë‹¤.\n- ìš°ì„ ìˆœìœ„ ì•Œë¦¼: ì•Œë¦¼ ìš°ì„ ìˆœìœ„ë¥¼ í• ë‹¹í•˜ê³  `Slack`ì„ í†µí•´ ì‹ ì†í•˜ê²Œ ì•Œë¦¼ì„ ë³´ë‚´ ê³ ìœ„í—˜ í™œë™ì— ì¦‰ì‹œ ì£¼ì˜ë¥¼ ê¸°ìš¸ì…ë‹ˆë‹¤.\n- ì‹¬ì¸µ ì¡°ì‚¬: ë¡œê·¸ì¸ ê¸°ë¡ì„ êµì°¨ ì°¸ì¡°í•˜ì—¬ ì´ìƒ ì§•í›„ë¥¼ ì‹ë³„í•˜ê³  ì ì¬ì  ìœ„í˜‘ì„ í”Œë˜ê·¸í•˜ì—¬ ë³´ì•ˆ íŒ€ì´ í•œ ë°œ ì•ì„œê²Œ í•©ë‹ˆë‹¤.\n\nì„¤ì •ì´ ì‰½ê³  ì ì‘ë ¥ì´ ê°•í•œ ì´ n8n ì›Œí¬í”Œë¡œìš°ëŠ” ë””ì§€í„¸ í™˜ê²½ì„ ë³´í˜¸í•˜ëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤.\n\n## â–¶ï¸ì´ˆê¸° íŠ¸ë¦¬ê±°: ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸ ê°ì§€\n\nì´ ì›Œí¬í”Œë¡œìš°ì˜ ì´ˆê¸° íŠ¸ë¦¬ê±°ëŠ” ìƒˆë¡œìš´ ë¡œê·¸ì¸ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ìƒˆë¡œìš´ /login ì´ë²¤íŠ¸ë¥¼ íŠ¸ë¦¬ê±°í•˜ë„ë¡ ì„¤ì •ëœ ì›¹í›…(`New /login event` ë…¸ë“œ)ê³¼ í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ìˆ˜ë™ íŠ¸ë¦¬ê±°(`When clicking \"Execute Workflow\"` ë…¸ë“œ)ì˜ ì¡°í•©ìœ¼ë¡œ ë‹¬ì„±ë©ë‹ˆë‹¤. ì›¹í›…ì€ ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì—ì„œ IP ì£¼ì†Œì™€ ì‚¬ìš©ì ì„¸ë¶€ ì •ë³´ì™€ ê°™ì€ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìº¡ì²˜í•˜ë„ë¡ êµ¬ì„±ë©ë‹ˆë‹¤.\n\nì´ ì„¤ì •ì€ ë¡œê·¸ì¸ í™œë™ì˜ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ì— í•„ìˆ˜ì ì…ë‹ˆë‹¤. ë¡œê·¸ì¸ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì›Œí¬í”Œë¡œìš°ê°€ ì¦‰ì‹œ ì‘ë™í•˜ì—¬ `Extract relevant data` ë…¸ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê´€ë ¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤.\n\n### ì¶œë ¥"
      },
      "typeVersion": 1
    },
    {
      "id": "ff6bbb3c-1c14-4e94-bfae-58e8cbb098c4",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0.113308604309168,
        690
      ],
      "parameters": {
        "width": 469.4801859287644,
        "height": 736.6018800373852,
        "content": "![ipapi](https://i.imgur.com/OMhn14b.png)  \n## ğŸŒ IP-APIë¥¼ ì‚¬ìš©í•œ IP ì§€ë¦¬ ìœ„ì¹˜ ì •ë³´  \n\"Suspicious Login Detection\" ì›Œí¬í”Œë¡œìš°ì˜ `IP API` ë…¸ë“œëŠ” ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì— ì¤‘ìš”í•œ ì§€ë¦¬ ìœ„ì¹˜ ë§¥ë½ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ì „ì— ì¶”ì¶œëœ IP ì£¼ì†Œì— ëŒ€í•œ ì§€ë¦¬ì  ë°ì´í„°ë¥¼ IP-APIì—ì„œ ì¡°íšŒí•©ë‹ˆë‹¤.  \n\n- **ì§€ë¦¬ì  í†µì°°ë ¥:** ì´ ë…¸ë“œëŠ” êµ­ê°€, ì§€ì—­, ë„ì‹œì™€ ê°™ì€ ì§€ë¦¬ì  ì„¸ë¶€ ì •ë³´ë¥¼ ì œê³µí•˜ì—¬ ë³´ì•ˆ ìœ„í—˜ì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ë¹„ì •ìƒì ì¸ ë¡œê·¸ì¸ ìœ„ì¹˜ë¥¼ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.  \n- **ë³´ì•ˆ ë¶„ì„ ê°•í™”:** ì§€ë¦¬ì  ë°ì´í„°ëŠ” ë¡œê·¸ì¸ ì‹œë„ì˜ í•©ë²•ì„±ì„ í‰ê°€í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë©°, ë³´ì•ˆ ë¶„ì„ì— ì¤‘ìš”í•œ ë ˆì´ì–´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.  \n\n### ì¸ì¦ - ë¬´ë£Œ í‹°ì–´ ì‚¬ìš© ê°€ëŠ¥ (45 ìš”ì²­/ë¶„)  \nì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” `IP ì£¼ì†Œë‹¹ 45íšŒ ìš”ì²­/ë¶„`ìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤.  \n\nì œí•œì„ ì´ˆê³¼í•˜ë©´ ìš”ì²­ì´ ì œí•œë©ë‹ˆë‹¤ `(HTTP 429)`ê¹Œì§€ ìš”ê¸ˆ í•œë„ ì°½ì´ ì¬ì„¤ì •ë  ë•Œê¹Œì§€. ì§€ì†ì ìœ¼ë¡œ ì œí•œì„ ì´ˆê³¼í•˜ë©´ IP ì£¼ì†Œê°€ 1ì‹œê°„ ë™ì•ˆ ì°¨ë‹¨ë©ë‹ˆë‹¤.  \n\nì¸ì¦ ë¶ˆí•„ìš”, [ë¬¸ì„œ ë³´ê¸°.](https://ip-api.com/docs)  \n\n### ì¶œë ¥"
      },
      "typeVersion": 1
    },
    {
      "id": "57adbcf5-f927-4bdb-b863-bcff97be0ace",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        1435
      ],
      "parameters": {
        "width": 470.4372486447854,
        "height": 1044.866146557656,
        "content": "![userparser](https://i.imgur.com/IxvDyZB.png)  \n## ğŸ”„ ì§€ë¦¬ì  ìœ„ì¹˜ ë° ì‚¬ìš©ì ì—ì´ì „íŠ¸ ë°ì´í„° ë³‘í•©\n\n\"Suspicious Login Detection\" ì›Œí¬í”Œë¡œìš°ì—ì„œ `Merge` ë…¸ë“œëŠ” `IP API` ë° `UserParser` ë…¸ë“œì˜ ì •ë³´ë¥¼ ì¢…í•©í•˜ëŠ” í•µì‹¬ ì—­í• ì„ í•©ë‹ˆë‹¤.\n\n- **ë°ì´í„° í†µí•©:** `Merge` ë…¸ë“œëŠ” `IP API` ë…¸ë“œì˜ ì§€ë¦¬ì  ìœ„ì¹˜ ì„¸ë¶€ ì •ë³´ì™€ `UserParser` ë…¸ë“œì˜ ì‚¬ìš©ì ì—ì´ì „íŠ¸ ì •ë³´ë¥¼ ê²°í•©í•©ë‹ˆë‹¤. ì´ í†µí•©ì„ í†µí•´ ê° ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì— ëŒ€í•œ í¬ê´„ì ì¸ ê´€ì ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n- **í¬ê´„ì ì¸ ë¶„ì„:** ì§€ë¦¬ì  ìœ„ì¹˜ì™€ ì‚¬ìš©ì ì—ì´ì „íŠ¸ ë°ì´í„°ë¥¼ ë³‘í•©í•˜ì—¬ ì›Œí¬í”Œë¡œëŠ” ê° ë¡œê·¸ì¸ ì‹œë„ ë’¤ì˜ ë§¥ë½ì„ ë” ì™„ì „íˆ ì´í•´í•  ìˆ˜ ìˆìœ¼ë©°, ë³´ì•ˆ ìœ„í—˜ì„ ì •í™•í•˜ê²Œ í‰ê°€í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n\n- **íš¨ìœ¨ì ì¸ ì›Œí¬í”Œë¡œìš° ì„¤ê³„:** `Merge` ë…¸ë“œì˜ ì‚¬ìš©ì€ n8nì´ ë‹¤ì–‘í•œ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ëª¨ë“  ê´€ë ¨ ì •ë³´ë¥¼ í†µí•©ëœ ë¶„ì„ì„ ìœ„í•´ ëª¨ìœ¼ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.\n\n### ì¸ì¦ - ë¬´ë£Œ í‹°ì–´ ì‚¬ìš© ê°€ëŠ¥ (ì›” 10000 í˜¸ì¶œ)  \nì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” `í•˜ë£¨ 500 í˜¸ì¶œ`ìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤.\n\nUserParserì˜ API í‚¤ë¥¼ ì„¤ì •í•˜ë ¤ë©´ `UserParser HTTP Request` ë…¸ë“œë¥¼ ì—´ê³  ìƒˆ ì¸ì¦ ìê²©ì¦ëª…ì„ ì¶”ê°€í•˜ì„¸ìš”. `Generic Credential Type`ì„ ì„ íƒí•œ í›„ `Query Auth`ë¥¼ ì„ íƒí•˜ì„¸ìš”. ë§ˆì§€ë§‰ìœ¼ë¡œ `Credential for Query Auth`ì—ì„œ ì´ë¦„ì„ `api_key`ë¡œ, ê°’ì„ ì‹¤ì œ `API í‚¤`ë¡œ ì„¤ì •í•˜ì„¸ìš”.\n\n[ë¬¸ì„œë¥¼ ë³´ë ¤ë©´ ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”.](https://www.userparser.com/docs/user-agent-and-geoip-lookup-api-v1.1)\n\n### ì¶œë ¥"
      },
      "typeVersion": 1
    },
    {
      "id": "44830be0-428a-492e-97f7-66289fac6231",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1184,
        1590
      ],
      "parameters": {
        "width": 659.8254746666762,
        "height": 845.1421530016269,
        "content": "## ğŸ“± ì¥ì¹˜ ë° ë¸Œë¼ìš°ì € ì´ìƒ ì‹ë³„\n`Parse User Agent` ë° `New Device/Browser?` ë…¸ë“œëŠ” ë¡œê·¸ì¸ ì´ë²¤íŠ¸ì˜ ì¥ì¹˜ ë° ë¸Œë¼ìš°ì € ì‚¬ìš©ì—ì„œ ì´ìƒì„ ê°ì§€í•˜ëŠ” ë° ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.\n\n-   **User Agent ë°ì´í„° êµ¬ë¬¸ ë¶„ì„:** `Parse User Agent` ë…¸ë“œëŠ” UserParser APIë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ë¡œê·¸ì¸ ì‹œë„ì˜ user agent ë¬¸ìì—´ì„ ë¶„ì„í•©ë‹ˆë‹¤. ì´ ë…¸ë“œëŠ” ë¡œê·¸ì¸ì— ì‚¬ìš©ëœ ë¸Œë¼ìš°ì €, ìš´ì˜ ì²´ì œ ë° ì¥ì¹˜ ìœ í˜•ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ì—¬ ë¡œê·¸ì¸ í™˜ê²½ì— ëŒ€í•œ ì¤‘ìš”í•œ í†µì°°ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n-   **ê³¼ê±° ë°ì´í„°ì™€ ë¹„êµ:** User agent ë°ì´í„°ë¥¼ êµ¬ë¬¸ ë¶„ì„í•œ í›„, ì›Œí¬í”Œë¡œëŠ” `New Device/Browser?` ë…¸ë“œë¡œ ì§„í–‰ë©ë‹ˆë‹¤. ì´ ë…¸ë“œëŠ” í˜„ì¬ ë¡œê·¸ì¸ì˜ ì¥ì¹˜ ë° ë¸Œë¼ìš°ì € ì„¸ë¶€ ì •ë³´ë¥¼ ì‚¬ìš©ìì˜ ê³¼ê±° ë°ì´í„°( `Get last 10 logins from the same user` ë…¸ë“œì—ì„œ ê²€ìƒ‰ë¨)ì™€ ë¹„êµí•˜ì—¬ ë¶ˆì¼ì¹˜ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n\n-   **ìƒˆ ì¥ì¹˜ ë˜ëŠ” ë¸Œë¼ìš°ì € ì‚¬ìš© ê°ì§€:** `New Device/Browser?` ë…¸ë“œëŠ” ë¸Œë¼ìš°ì € ì´ë¦„, ìš´ì˜ ì²´ì œ ë˜ëŠ” ì¥ì¹˜ ìœ í˜•ì— ë³€ê²½ì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ë³€ê²½ì´ ìˆìœ¼ë©´ í˜„ì¬ ë¡œê·¸ì¸ì´ ìƒˆ ì¥ì¹˜ ë˜ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì‹œë„ë˜ê³  ìˆìŒì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë¬´ë‹¨ ì ‘ê·¼ì˜ ì‹ í˜¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n-   **ì¥ì¹˜ ë° ë¸Œë¼ìš°ì € ì¼ê´€ì„±ì— ë”°ë¥¸ ë¼ìš°íŒ…:** ì´ ë¶„ì„ì— ë”°ë¼ ì›Œí¬í”Œë¡œê°€ ë¶„ê¸°ë©ë‹ˆë‹¤. ìƒˆ ì¥ì¹˜ ë˜ëŠ” ë¸Œë¼ìš°ì €ê°€ ê°ì§€ë˜ë©´ íë¦„ì´ `New Device/Browser` ë…¸ë“œë¡œ ì´ë™í•˜ì—¬ ì ì¬ì  ë³´ì•ˆ ìœ„í—˜ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ, ì¥ì¹˜ ë° ë¸Œë¼ìš°ì €ê°€ ê³¼ê±° íŒ¨í„´ê³¼ ì¼ì¹˜í•˜ë©´ `Old Device/Browser` ë…¸ë“œê°€ í™œì„±í™”ë˜ì–´ ì¼ìƒì ì¸ ë¡œê·¸ì¸ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "e0bcc621-ff1f-47ca-a63a-f1af5c521c9a",
      "name": "Known, Do Nothing",
      "type": "n8n-nodes-base.noOp",
      "position": [
        960,
        1440
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "92c08a63-6961-40f6-993e-052a311f4bb6",
      "name": "Known Location",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1660,
        1420
      ],
      "parameters": {},
      "executeOnce": true,
      "typeVersion": 1
    },
    {
      "id": "bb1621e0-8297-4e6c-bcdf-eae683a4b830",
      "name": "Old Device/Browser",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1674,
        1765
      ],
      "parameters": {},
      "executeOnce": true,
      "typeVersion": 1
    },
    {
      "id": "9c987dd1-8d27-4067-9956-712eae4a228c",
      "name": "Not Riot",
      "type": "n8n-nodes-base.noOp",
      "position": [
        780,
        520
      ],
      "parameters": {},
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "cd2fd77a-2903-44b8-826a-6797efb5f871",
  "connections": {
    "HTML": {
      "main": [
        [
          {
            "node": "Inform user",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Complete login info",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "riot?": {
      "main": [
        [
          {
            "node": "Check trust level",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Not Riot",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IP API": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "noise?": {
      "main": [
        [
          {
            "node": "Check classification",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "riot?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GreyNoise": {
      "main": [
        [
          {
            "node": "Complete login info",
            "type": "main",
            "index": 0
          },
          {
            "node": "noise?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "UserParser": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "New Location": {
      "main": [
        [
          {
            "node": "Query user by ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Example event": {
      "main": [
        [
          {
            "node": "Extract relevant data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New location?": {
      "main": [
        [
          {
            "node": "New Location",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Known Location",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Query IP API1": {
      "main": [
        [
          {
            "node": "New location?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Unknown threat?": {
      "main": [
        [
          {
            "node": "Get last 10 logins from the same user",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Known, Do Nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "User has email?": {
      "main": [
        [
          {
            "node": "HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New /login event": {
      "main": [
        [
          {
            "node": "Extract relevant data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse User Agent": {
      "main": [
        [
          {
            "node": "New Device/Browser?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Query user by ID": {
      "main": [
        [
          {
            "node": "User has email?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check trust level": {
      "main": [
        [],
        [
          {
            "node": "ğŸ”´ Priority: HIGH",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸŸ¡ Priority: MEDIUM",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸŸ¢ Priority: LOW",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New Device/Browser": {
      "main": [
        [
          {
            "node": "Query user by ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŸ¢ Priority: LOW": {
      "main": [
        [
          {
            "node": "Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Complete login info": {
      "main": [
        [
          {
            "node": "Unknown threat?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New Device/Browser?": {
      "main": [
        [
          {
            "node": "New Device/Browser",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Old Device/Browser",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”´ Priority: HIGH": {
      "main": [
        [
          {
            "node": "Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check classification": {
      "main": [
        [
          {
            "node": "ğŸ”´ Priority: HIGH",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸŸ¡ Priority: MEDIUM",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸŸ¢ Priority: LOW",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract relevant data": {
      "main": [
        [
          {
            "node": "GreyNoise",
            "type": "main",
            "index": 0
          },
          {
            "node": "UserParser",
            "type": "main",
            "index": 0
          },
          {
            "node": "IP API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŸ¡ Priority: MEDIUM": {
      "main": [
        [
          {
            "node": "Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Execute Workflow\"": {
      "main": [
        [
          {
            "node": "Example event",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get last 10 logins from the same user": {
      "main": [
        [
          {
            "node": "Query IP API1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Parse User Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}