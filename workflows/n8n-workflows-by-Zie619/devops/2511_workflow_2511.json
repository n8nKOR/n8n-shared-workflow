{
  "meta": {
    "instanceId": "03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8"
  },
  "nodes": [
    {
      "id": "be5b0c9c-de92-4e34-88cb-98e88b0c19df",
      "name": "Start VM Scan in Qualys",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1340,
        500
      ],
      "parameters": {
        "": "",
        "url": "={{ $json.platformurl }}/api/2.0/fo/scan/",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "sendQuery": true,
        "curlImport": "",
        "contentType": "multipart-form-data",
        "infoMessage": "",
        "sendHeaders": true,
        "specifyQuery": "keypair",
        "authentication": "predefinedCredentialType",
        "bodyParameters": {
          "parameters": [
            {
              "name": "asset_groups",
              "value": "={{ $json.asset_groups }}",
              "parameterType": "formData"
            },
            {
              "name": "scan_title",
              "value": "={{ $json.scan_title }}",
              "parameterType": "formData"
            },
            {
              "name": "option_title",
              "value": "={{ $json.option_title }}",
              "parameterType": "formData"
            }
          ]
        },
        "specifyHeaders": "keypair",
        "queryParameters": {
          "parameters": [
            {
              "name": "action",
              "value": "launch"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Requested-With",
              "value": "n8n"
            }
          ]
        },
        "httpVariantWarning": "",
        "nodeCredentialType": "qualysApi",
        "provideSslCertificates": false
      },
      "credentials": {
        "qualysApi": {
          "id": "KdkmNjVYkDUzHAvw",
          "name": "Qualys account"
        }
      },
      "typeVersion": 4.2,
      "extendsCredential": "qualysApi"
    },
    {
      "id": "0d140ce1-89e0-4135-821f-0b32004fc6aa",
      "name": "Convert XML to JSON",
      "type": "n8n-nodes-base.xml",
      "position": [
        1540,
        500
      ],
      "parameters": {
        "options": {},
        "dataPropertyName": "=data"
      },
      "typeVersion": 1
    },
    {
      "id": "ec737485-bf8b-4e8a-9843-2566c13106a8",
      "name": "Fetch Scan Results",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2640,
        460
      ],
      "parameters": {
        "": "",
        "url": "={{ $('Demo Data').item.json[\"platformurl\"] }}/api/2.0/fo/scan/vm/summary",
        "method": "GET",
        "options": {},
        "sendBody": false,
        "sendQuery": true,
        "curlImport": "",
        "infoMessage": "",
        "sendHeaders": true,
        "specifyQuery": "keypair",
        "authentication": "predefinedCredentialType",
        "specifyHeaders": "keypair",
        "queryParameters": {
          "parameters": [
            {
              "name": "action",
              "value": "list"
            },
            {
              "name": "scan_reference",
              "value": "={{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Requested-With",
              "value": "n8n"
            }
          ]
        },
        "httpVariantWarning": "",
        "nodeCredentialType": "qualysApi",
        "provideSslCertificates": false
      },
      "credentials": {
        "qualysApi": {
          "id": "KdkmNjVYkDUzHAvw",
          "name": "Qualys account"
        }
      },
      "typeVersion": 4.2,
      "extendsCredential": "qualysApi"
    },
    {
      "id": "56a60798-3db1-4c69-962f-75009f894196",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        2220,
        420
      ],
      "parameters": {
        "options": {
          "reset": true
        }
      },
      "typeVersion": 3
    },
    {
      "id": "37ac0cdf-8412-40c7-b01c-d592e4d1f378",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2560,
        180
      ],
      "parameters": {
        "color": 7,
        "width": 596.2964035541726,
        "height": 493.43675548817004,
        "content": "![Imgur](https://uploads.n8n.io/templates/qualys.png)  \nQualys ì¸¡ì—ì„œ ìˆ˜í–‰ë˜ëŠ” ì¿¼ë¦¬ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [Manage Scans Documentation](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Fmanage_vm_scans.htm)ì„ í™•ì¸í•˜ì„¸ìš”. ê²°ê³¼ëŠ” XML í˜•ì‹ìœ¼ë¡œ ë°˜í™˜ë˜ë©°, n8nì€ ì´ë¥¼ ê¸°ë³¸ì ìœ¼ë¡œ JSONìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ n8nì—ì„œ ìƒíƒœë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "075a4e21-cc30-4e31-a1f9-d2f872ab978c",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1274.994996265108,
        51.04030212612997
      ],
      "parameters": {
        "color": 7,
        "width": 447.57018680355174,
        "height": 642.6627860215806,
        "content": "![Qualys](https://uploads.n8n.io/templates/qualys.png)  \n## Qualys ì—ì´ì „íŠ¸ì—ì„œ ìŠ¤ìº” íŠ¸ë¦¬ê±°  \nìŠ¤ìº” ì‹œì‘ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ë¥¼ ìœ„í•´, [ì‹œì‘ ë¬¸ì„œ](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)ë¥¼ ë°©ë¬¸í•˜ì„¸ìš”. Qualysì˜ ì‘ë‹µì€ XML í˜•ì‹ìœ¼ë¡œ ë˜ì–´ ìˆìœ¼ë©°, n8nì´ ì‰½ê²Œ ì²˜ë¦¬í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "5da3f500-0ccf-4eed-9d05-7709668cf2bb",
      "name": "Wait 5 Min",
      "type": "n8n-nodes-base.wait",
      "position": [
        2440,
        460
      ],
      "webhookId": "f2d07724-882a-4010-9ce2-ff389ee962af",
      "parameters": {
        "unit": "minutes"
      },
      "typeVersion": 1.1
    },
    {
      "id": "5cf921ac-cd6b-4a27-b679-3d1ecdb3eb49",
      "name": "Convert XML to JSON1",
      "type": "n8n-nodes-base.xml",
      "position": [
        2800,
        460
      ],
      "parameters": {
        "options": {},
        "dataPropertyName": "=data"
      },
      "typeVersion": 1
    },
    {
      "id": "0580bb11-38c4-49a1-ab00-4cdfb49c8f9d",
      "name": "Check if Scan Finished",
      "type": "n8n-nodes-base.if",
      "position": [
        3000,
        460
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "ef397200-064a-428f-a5b2-19d2342a9113",
              "operator": {
                "name": "filter.operator.equals",
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.SCAN_SUMMARY_OUTPUT.RESPONSE.SCAN_SUMMARY_LIST.SCAN_SUMMARY.SCAN_DETAILS.STATUS }}",
              "rightValue": "FINISHED"
            }
          ]
        }
      },
      "typeVersion": 2
    },
    {
      "id": "ec05f06b-e009-4f1c-97e4-223705d3be32",
      "name": "Execute Workflow Trigger",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        260,
        520
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "1cbd10cd-342c-41bf-ae8f-832324cfbb30",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        220,
        40
      ],
      "parameters": {
        "color": 7,
        "width": 1043.6429958055905,
        "height": 657.4661247924577,
        "content": "![Slack](https://uploads.n8n.io/templates/slack.png)  \n## Slack ë¶€ëª¨ ì›Œí¬í”Œë¡œìš°ì—ì„œ íŠ¸ë¦¬ê±°ë¨  \nì›Œí¬í”Œë¡œìš°ëŠ” ì‹¤í–‰ ì›Œí¬í”Œë¡œìš° íŠ¸ë¦¬ê±°ë¡œ ì‹œì‘í•˜ì§€ë§Œ, ìˆ˜ë™ ì‹¤í–‰ íŠ¸ë¦¬ê±°ëŠ” ìˆ˜ë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë‚¨ê²¨ì ¸ ìˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•  ë•Œ ì‹¤í–‰ ì›Œí¬í”Œë¡œìš° íŠ¸ë¦¬ê±°ë¥¼ ë„ëŠ” ê²ƒì„ í™•ì¸í•˜ì„¸ìš”. ëª¨ë“  Slack ë…¸ë“œì—ì„œ ë™ì¼í•œ ì±„ë„ì´ ì„¤ì •ë˜ë„ë¡ Edit ë…¸ë“œì—ì„œ Slack ì±„ë„ IDë¥¼ ì„¤ì •í•˜ì„¸ìš”. ê·¸ í›„, n8nì€ ì‚¬ìš©ìê°€ ìš”ì²­ì„ ì²˜ë¦¬ ì¤‘ì„ì„ ì•Œë¦¬ê¸° ìœ„í•´ Slackì— ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤. ë‘ ìŠ¤ë ˆë“œê°€ ë³‘í•©ë˜ì–´ í•œ ë²ˆì— í•˜ë‚˜ì˜ ì‘ì—…ë§Œ ìˆ˜í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤. ê¸€ë¡œë²Œ ë³€ìˆ˜ì— Platform URLì„ ì„¤ì •í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. ì´ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” Qualysì˜ [í”Œë«í¼ ë¬¸ì„œ](https://www.qualys.com/platform-identification/) í˜ì´ì§€ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "fb59e00b-36c6-429e-8696-f49b78445925",
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2160,
        60
      ],
      "parameters": {
        "color": 7,
        "width": 387.82834121275613,
        "height": 620.5198690828006,
        "content": "![n8n](https://uploads.n8n.io/templates/n8n.png)  \n## n8n ë£¨í”„ ë…¸ë“œ  \në³´ê³ ì„œ ê°ì²´ê°€ ì¿¼ë¦¬ëœ ë‹¤ìŒ ë³´ê³ ì„œê°€ ì™„ë£Œëœ ìƒíƒœë¥¼ ë°˜í™˜í•  ë•Œê¹Œì§€ 5ë¶„ë§ˆë‹¤ ë£¨í”„í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë³´ê³ ì„œê°€ 40ë¶„ ì´ìƒ ê±¸ë¦´ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ n8nì´ ê°œì…í•˜ì—¬ 5ë¶„ë§ˆë‹¤ ìš°ë¦¬ë¥¼ ìœ„í•´ í™•ì¸í•©ë‹ˆë‹¤. ìŠ¤ìº”ì˜ ìƒíƒœê°€ ì™„ë£Œë¡œ ë³€ê²½ë˜ë©´ ë£¨í”„ê°€ ì¢…ë£Œë˜ê³  ê²°ê³¼ê°€ ìŠ¤ìº” ê²°ê³¼ë¡œ ëŒì•„ê°€ëŠ” ë§í¬ì™€ í•¨ê»˜ Slackì— ê²Œì‹œë©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "2337ad0e-e361-474a-9923-75c4826400b6",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3167,
        184.84774251864644
      ],
      "parameters": {
        "color": 7,
        "width": 679.3808146538605,
        "height": 493.10714356069377,
        "content": "![Imgur](https://uploads.n8n.io/templates/slack.png)  \n## ë³´ê³ ì„œ Slackì— ì—…ë¡œë“œ  \nìŠ¤ìº”ì´ ì™„ë£Œë˜ë©´, ë³´ê³ ì„œì˜ ìš”ì•½ê³¼ ë³´ê³ ì„œ ê°ì²´ì— ëŒ€í•œ ë§í¬ê°€ Slackì— ê²Œì‹œë˜ì–´ ì‰½ê²Œ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì›ë˜ì˜ ì˜ìˆ˜ì¦ ë©”ì‹œì§€ê°€ ì‚­ì œë˜ì–´ ìƒˆ ë©”ì‹œì§€ê°€ Slack ì•Œë¦¼ì„ ìƒì„±í•˜ë„ë¡ í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "68a9eee6-05c4-4655-ab74-4a68fc68af26",
      "name": "Post Receipt",
      "type": "n8n-nodes-base.slack",
      "position": [
        740,
        340
      ],
      "parameters": {
        "text": "Vulnerability Scan request received, processing now. ",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Global Variables & Slack Channel').item.json[\"slackChannelId\"] }}"
        },
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "credentials": {
        "slackApi": {
          "id": "DZJDes1ZtGpqClNk",
          "name": "Qualys Slack App"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "43af793b-061f-4048-b110-546903b803b6",
      "name": "Confirm Waiting",
      "type": "n8n-nodes-base.slack",
      "position": [
        1800,
        540
      ],
      "parameters": {
        "ts": "={{ $('Save receipt message timestamp').item.json[\"ts\"] }}",
        "text": "=Scan successfully initiated, now waiting for `{{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}` to complete. \n\nNo action is needed, and I will post the summary report and link to results when it's complete. ",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Global Variables & Slack Channel').item.json[\"slackChannelId\"] }}"
        },
        "operation": "update",
        "updateFields": {
          "parse": "client",
          "link_names": false
        }
      },
      "credentials": {
        "slackApi": {
          "id": "DZJDes1ZtGpqClNk",
          "name": "Qualys Slack App"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "326bb10c-0e8e-4df7-bc67-dad015240d15",
      "name": "Delete Receipt",
      "type": "n8n-nodes-base.slack",
      "position": [
        3480,
        440
      ],
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Global Variables & Slack Channel').item.json[\"slackChannelId\"] }}"
        },
        "operation": "delete",
        "timestamp": "={{ $('Save receipt message timestamp').item.json[\"ts\"] }}"
      },
      "credentials": {
        "slackApi": {
          "id": "DZJDes1ZtGpqClNk",
          "name": "Qualys Slack App"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "c8668283-e6ec-4dbd-92d0-aec1f07c01a7",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1740.3532113511565,
        44.007696543933434
      ],
      "parameters": {
        "color": 7,
        "width": 408.91770357210225,
        "height": 645.055566466257,
        "content": "![Slack](https://uploads.n8n.io/templates/slack.png)  \n## ì‚¬ìš©ìê°€ ì•Œë„ë¡ í•˜ì„¸ìš”, ì´ì œ ê¸°ë‹¤ë¦´ ì‹œê°„ì´ ë˜ì—ˆìŠµë‹ˆë‹¤  \nì¢‹ì€ ê³ ê° ì„œë¹„ìŠ¤ëŠ” ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì—ì„œ ë¹„ë¡¯ë©ë‹ˆë‹¤. ì´ ì„¹ì…˜ì€ ìŠ¤ìº”ì´ ì„±ê³µì ìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ì—ˆìŒì„ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¬ê³ , ì´ì œ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•¨ì„ ì•Œë ¤ì¤ë‹ˆë‹¤. í•„ìš”ì— ë”°ë¼ ì´ ë©”ì‹œì§€ë¥¼ ììœ ë¡­ê²Œ ë³€ê²½í•˜ì„¸ìš”. ê²°ê³¼ê°€ ê²Œì‹œë˜ë©´ ì‚­ì œë©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "defa2773-ea65-481d-a6d6-bb40c70e6762",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -440,
        40
      ],
      "parameters": {
        "width": 646.7396383244529,
        "height": 994.2389415638766,
        "content": "![n8n](https://uploads.n8n.io/templates/n8n.png)  \n# Qualys ì·¨ì•½ì  íŠ¸ë¦¬ê±° ìŠ¤ìº” ì›Œí¬í”Œë¡œìš°\n\n## ì´ ì›Œí¬í”Œë¡œëŠ” Slack ë‹¨ì¶•í‚¤ë¥¼ í†µí•´ ì‹œì‘ëœ ìƒìœ„ ì›Œí¬í”Œë¡œìš°ì— ì˜í•´ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤. í™œì„±í™”ë˜ë©´ Slackì˜ ëª¨ë‹¬ ì°½ì—ì„œ ì…ë ¥ì„ ìˆ˜ì§‘í•˜ê³  Qualys APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì·¨ì•½ì  ìŠ¤ìº”ì„ ì‹œì‘í•©ë‹ˆë‹¤.\n\n**ì£¼ìš” ê¸°ëŠ¥:**  \n- **íŠ¸ë¦¬ê±°:** Slack ë‹¨ì¶•í‚¤ë¥¼ í†µí•´ ëª¨ë‹¬ ì…ë ¥ê³¼ í•¨ê»˜ ìƒìœ„ ì›Œí¬í”Œë¡œìš°ì— ì˜í•´ ì‹œì‘ë©ë‹ˆë‹¤.  \n- **API í†µí•©:** Qualys APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì·¨ì•½ì  ìŠ¤ìº”ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.  \n- **ë°ì´í„° ë³€í™˜:** XML ìŠ¤ìº” ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•©ë‹ˆë‹¤.  \n- **ë£¨í”„ ë©”ì»¤ë‹ˆì¦˜:** ìŠ¤ìº”ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì§€ì†ì ìœ¼ë¡œ ìŠ¤ìº” ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.  \n- **Slack ì•Œë¦¼:** ì§€ì •ëœ Slack ì±„ë„ì— ìŠ¤ìº” ìš”ì•½ ë° ìƒì„¸ ê²°ê³¼ë¥¼ ê²Œì‹œí•©ë‹ˆë‹¤.\n\n**ì›Œí¬í”Œë¡œìš° ë…¸ë“œ:**  \n1. **Qualysì—ì„œ VM ìŠ¤ìº” ì‹œì‘:** ì§€ì •ëœ ë§¤ê°œë³€ìˆ˜ë¡œ ìŠ¤ìº”ì„ ì‹œì‘í•©ë‹ˆë‹¤.  \n2. **XMLì„ JSONìœ¼ë¡œ ë³€í™˜:** ìŠ¤ìº” ê²°ê³¼ë¥¼ XML í˜•ì‹ì—ì„œ JSONìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.  \n3. **ìŠ¤ìº” ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°:** Qualysì—ì„œ ìŠ¤ìº” ê²°ê³¼ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.  \n4. **ìŠ¤ìº” ì™„ë£Œ í™•ì¸:** ìŠ¤ìº”ì´ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.  \n5. **ë£¨í”„ ë©”ì»¤ë‹ˆì¦˜:** ìŠ¤ìº” ìƒíƒœë¥¼ ë°˜ë³µì ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤.  \n6. **Slack ì•Œë¦¼:** Slackì— ì—…ë°ì´íŠ¸ ë° ê²°ê³¼ë¥¼ ê²Œì‹œí•©ë‹ˆë‹¤.\n\n**ê´€ë ¨ ë§í¬:**  \n- [Qualys API ë¬¸ì„œ](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)  \n- [Qualys í”Œë«í¼ ë¬¸ì„œ](https://www.qualys.com/platform-identification/)"
      },
      "typeVersion": 1
    },
    {
      "id": "de2c15bd-4144-4ca8-9c0d-370ecf334650",
      "name": "Demo Data",
      "type": "n8n-nodes-base.set",
      "position": [
        560,
        520
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "070178a6-73b0-458b-8657-20ab4ff0485c",
              "name": "option_title",
              "type": "string",
              "value": "Initial Options"
            },
            {
              "id": "3605424b-5bfc-44f0-b6e4-e0d6b1130b8e",
              "name": "scan_title",
              "type": "string",
              "value": "n8n Scan 1"
            },
            {
              "id": "2320d966-b834-46fb-b674-be97cc08682e",
              "name": "asset_groups",
              "type": "string",
              "value": "Group1"
            }
          ]
        }
      },
      "typeVersion": 3.3
    },
    {
      "id": "0ec55480-424c-4686-b8f7-8a98b5941c8e",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        820,
        700
      ],
      "parameters": {
        "color": 5,
        "width": 535.8333316661617,
        "height": 702.5170959123625,
        "content": "ì´ ëª¨ë‹¬ì— ì…ë ¥ëœ ë°ì´í„°ëŠ” ì´ ì›Œí¬í”Œë¡œìš°ì—ì„œ ì²˜ë¦¬ë  ê²ƒì…ë‹ˆë‹¤"
      },
      "typeVersion": 1
    },
    {
      "id": "9f6291ad-280f-4a0c-b84a-5eebfbb9172f",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        1120,
        500
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combinationMode": "multiplex"
      },
      "typeVersion": 2.1
    },
    {
      "id": "783d9bcd-faf1-4427-ab5c-de32df64f819",
      "name": "Post Vulnerability Scan Summary to Slack",
      "type": "n8n-nodes-base.slack",
      "position": [
        3240,
        500
      ],
      "parameters": {
        "select": "channel",
        "blocksUi": "={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"image\",\n\t\t\t\"block_id\": \"image_1\",\n\t\t\t\"image_url\": \"https://i.imgur.com/6BtgQVV.png\",\n\t\t\t\"alt_text\": \"{{ $('Convert XML to JSON').item.json[\"SIMPLE_RETURN\"][\"RESPONSE\"][\"ITEM_LIST\"][\"ITEM\"][0][\"VALUE\"] }}\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"header\",\n\t\t\t\"block_id\": \"header_1\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\"text\": \"ğŸ“Š Qualys Scan Summary\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"block_id\": \"section_scan_details\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*ğŸ“ Scan Title:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"TITLE\"] }}\\n*ğŸ‘¤ User:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"USER\"][\"USERNAME\"] }}\\n*ğŸ” Scan Status:* FINISHED\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"block_id\": \"section_general_info\",\n\t\t\t\"fields\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*â±ï¸ Scheduled:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"SCHEDULED\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸ“‹ Option Profile:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"OPTION_PROFILE\"][\"NAME\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸ¯ Targets:* IP List ({{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"TARGETS\"][\"IP_LIST\"][\"COUNT\"] }} IPs), Asset Group {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"TARGETS\"][\"ASSET_GROUP_LIST\"][\"ASSET_GROUP_DATA\"][\"ASSET_GROUP\"][\"NAME\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸš€ Scan Launched:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_INPUT\"][\"SCAN_DATETIME\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*â³ Duration:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_DETAILS\"][\"DURATION\"] }} seconds\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸ–¥ï¸ Detected Hosts:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"HOSTS\"][\"COUNT\"] }}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"block_id\": \"section_detections_summary\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"*ğŸ” Detections Summary:*\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"block_id\": \"section_detections_details\",\n\t\t\t\"fields\": [\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸ›¡ï¸ Confirmed Vulnerabilities:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"TOTAL_COUNT\"] }}\\n   - Minimal Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_1\"] }}\\n   - Medium Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_2\"] }}\\n   - Serious Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_3\"] }}\\n   - Critical Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_4\"] }}\\n   - Urgent Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"CONFIRMED\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_5\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*ğŸ“ˆ Information Gathered:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"IG\"][\"TOTAL_COUNT\"] }}\\n   - Minimal Severity:  {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"IG\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_1\"] }}\\n   - Medium Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"IG\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_2\"] }}\\n   - Serious Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"IG\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_3\"] }}\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\t\"text\": \"*âš ï¸ Potential Vulnerabilities:* {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"TOTAL_COUNT\"] }}\\n   - Minimal Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_1\"] }}\\n   - Medium Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_2\"] }}\\n   - Serious Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_3\"] }}\\n   - Critical Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_4\"] }}\\n   - Urgent Severity: {{ $json[\"SCAN_SUMMARY_OUTPUT\"][\"RESPONSE\"][\"SCAN_SUMMARY_LIST\"][\"SCAN_SUMMARY\"][\"SCAN_RESULTS\"][\"DETECTIONS\"][\"VULN\"][\"POTENTIAL\"][\"COUNT_BY_SEVERITY\"][\"SEVERITY_5\"] }}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"block_id\": \"final_section_with_button\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"ğŸ”— View the full report in Qualys\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"text\": {\n\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\"text\": \"View Report in Qualys\",\n\t\t\t\t\t\"emoji\": true\n\t\t\t\t},\n\t\t\t\t\"value\": \"click_me_123\",\n\t\t\t\t\"style\": \"primary\",\n\t\t\t\t\"url\": \"{{ $('Demo Data').item.json[\"platformurl\"] }}/fo/report/report_view.php?id={{ $('Convert XML to JSON').item.json[\"SIMPLE_RETURN\"][\"RESPONSE\"][\"ITEM_LIST\"][\"ITEM\"][0][\"VALUE\"] }}&default=1&format=30\",\n\t\t\t\t\"action_id\": \"button-action\"\n\t\t\t}\n\t\t}\n\t]\n}",
        "channelId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Global Variables & Slack Channel').item.json[\"slackChannelId\"] }}"
        },
        "messageType": "block",
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "DZJDes1ZtGpqClNk",
          "name": "Qualys Slack App"
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "91444583-66d8-4d5b-ba88-4d8869d508b6",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "disabled": true,
      "position": [
        260,
        340
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "4b8ade25-0377-4f00-a744-f610b17eea93",
      "name": "Begin Wait Loop",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1800,
        400
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "b830b9d8-e7aa-49bb-9640-d1def697f3e1",
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "position": [
        2020,
        420
      ],
      "parameters": {
        "mode": "chooseBranch"
      },
      "typeVersion": 2.1
    },
    {
      "id": "389381c3-bd51-4e22-a102-e47b5945576c",
      "name": "Save receipt message timestamp",
      "type": "n8n-nodes-base.set",
      "position": [
        920,
        340
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "111526ec-0501-4af9-b66e-c677cb8fe25f",
              "name": "ts",
              "type": "string",
              "value": "={{ $json.message.ts }}"
            }
          ]
        }
      },
      "typeVersion": 3.3
    },
    {
      "id": "51005deb-2676-4375-9ac8-780eb301f7f5",
      "name": "Global Variables & Slack Channel",
      "type": "n8n-nodes-base.set",
      "position": [
        560,
        340
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "9849fe48-7a7a-4f2b-a404-c7827249e9c2",
              "name": "slackChannelId",
              "type": "string",
              "value": "C05LAN72WJK"
            },
            {
              "id": "36aad8b5-b51a-4df0-b1a7-159a90b802b2",
              "name": "platformurl",
              "type": "string",
              "value": "https://qualysapi.qg3.apps.qualys.com"
            }
          ]
        }
      },
      "typeVersion": 3.3
    },
    {
      "id": "7d6d5ab7-5a87-46c8-baa8-d79a05d8346d",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        220,
        700
      ],
      "parameters": {
        "color": 5,
        "width": 596.6847639718076,
        "height": 438.8903816479826,
        "content": "ğŸ¤– ì´ ì›Œí¬í”Œë¡œìš°ë¥¼ íŠ¸ë¦¬ê±°ë§í•˜ëŠ” ê²ƒì€ Slackì—ì„œ ë°±ìŠ¬ë˜ì‹œë¥¼ ì…ë ¥í•˜ê³  ì˜¤ë¥¸ìª½ ëª¨ë‹¬ì„ ì±„ìš°ëŠ” ë§Œí¼ ì‰½ìŠµë‹ˆë‹¤."
      },
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Merge": {
      "main": [
        [
          {
            "node": "Start VM Scan in Qualys",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Demo Data": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Wait 5 Min": {
      "main": [
        [
          {
            "node": "Fetch Scan Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post Receipt": {
      "main": [
        [
          {
            "node": "Save receipt message timestamp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Begin Wait Loop": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Confirm Waiting": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        null,
        [
          {
            "node": "Wait 5 Min",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Scan Results": {
      "main": [
        [
          {
            "node": "Convert XML to JSON1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert XML to JSON": {
      "main": [
        [
          {
            "node": "Confirm Waiting",
            "type": "main",
            "index": 0
          },
          {
            "node": "Begin Wait Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert XML to JSON1": {
      "main": [
        [
          {
            "node": "Check if Scan Finished",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if Scan Finished": {
      "main": [
        [
          {
            "node": "Delete Receipt",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post Vulnerability Scan Summary to Slack",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Start VM Scan in Qualys": {
      "main": [
        [
          {
            "node": "Convert XML to JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Workflow Trigger": {
      "main": [
        [
          {
            "node": "Demo Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Global Variables & Slack Channel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "Demo Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Global Variables & Slack Channel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save receipt message timestamp": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Global Variables & Slack Channel": {
      "main": [
        [
          {
            "node": "Post Receipt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}