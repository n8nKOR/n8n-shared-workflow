{
  "id": "8EmNhftXznAGV3dR",
  "meta": {
    "instanceId": "03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8"
  },
  "name": "Phishing_analysis__URLScan_io_and_Virustotal_",
  "tags": [
    {
      "id": "GCHVocImoXoEVnzP",
      "name": "ğŸ› ï¸ In progress",
      "createdAt": "2023-10-31T02:17:21.618Z",
      "updatedAt": "2023-10-31T02:17:21.618Z"
    },
    {
      "id": "QPJKatvLSxxtrE8U",
      "name": "Secops",
      "createdAt": "2023-10-31T02:15:11.396Z",
      "updatedAt": "2023-10-31T02:15:11.396Z"
    }
  ],
  "nodes": [
    {
      "id": "f170068a-4540-4fbd-bd17-00a6367989d1",
      "name": "When clicking \"Execute Workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -1760,
        560
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "5a1e0490-6971-4490-a806-46da5e226365",
      "name": "sends slack message",
      "type": "n8n-nodes-base.slack",
      "position": [
        -360,
        1280
      ],
      "parameters": {
        "text": "=*Email Analysis*\n\nSubject: {{ $('Microsoft Outlook').item.json[\"subject\"] }}\nFrom: {{ $('Microsoft Outlook').item.json[\"sender\"][\"emailAddress\"][\"address\"] }}\nDate: {{ $('Microsoft Outlook').item.json[\"sentDateTime\"] }}\n\nReport:\n\n*URLScan Report URL:* {{ $('urlscan.io').item.json.result ? $('urlscan.io').item.json.result : \"N/A\" }}\n*Virustotal report:* https://www.virustotal.com/gui/url/{{ $json[\"data\"][\"id\"].split(\"-\")[1] }}\n*Virustotal Verdict:* {{ $json.data.attributes.stats.malicious + $json.data.attributes.stats.suspicious }} / {{ Object.keys($json.data.attributes.results).length }}",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "mode": "name",
          "value": "test-giulio-public"
        },
        "otherOptions": {}
      },
      "credentials": {
        "slackApi": {
          "id": "252",
          "name": "Slack Bot Token | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 2
    },
    {
      "id": "65e70f8a-7514-455e-97bf-b11514b4eec2",
      "name": "Split In Batches",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        -1020,
        480
      ],
      "parameters": {
        "options": {},
        "batchSize": 1
      },
      "typeVersion": 2
    },
    {
      "id": "35084825-f3b2-4a01-b953-712c099a6451",
      "name": "Mark as read",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        -1300,
        560
      ],
      "parameters": {
        "messageId": "={{ $json.id }}",
        "operation": "update",
        "updateFields": {
          "isRead": true
        }
      },
      "credentials": {
        "microsoftOutlookOAuth2Api": {
          "id": "Zeu3LbjDbkwiCUik",
          "name": "Microsoft Outlook | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "62098c94-5735-4eed-a712-3f9887e0400f",
      "name": "VirusTotal: Scan URL",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -220,
        700
      ],
      "parameters": {
        "url": "https://www.virustotal.com/api/v3/urls",
        "method": "POST",
        "options": {},
        "sendQuery": true,
        "authentication": "predefinedCredentialType",
        "queryParameters": {
          "parameters": [
            {
              "name": "url",
              "value": "={{ $json.domain }}"
            }
          ]
        },
        "nodeCredentialType": "virusTotalApi"
      },
      "credentials": {
        "virusTotalApi": {
          "id": "hVTFFXxLV4oWPOb0",
          "name": "Virus Total | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "55b7ce97-3609-4a16-b998-8bec77cffb59",
      "name": "VirusTotal: Get report",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        200,
        700
      ],
      "parameters": {
        "url": "=https://www.virustotal.com/api/v3/analyses/{{ $json.data.id }}",
        "options": {},
        "sendQuery": true,
        "authentication": "predefinedCredentialType",
        "queryParameters": {
          "parameters": [
            {
              "name": "resource",
              "value": "https://developers.virustotal.com/v2.0/reference/url-report"
            }
          ]
        },
        "nodeCredentialType": "virusTotalApi"
      },
      "credentials": {
        "virusTotalApi": {
          "id": "hVTFFXxLV4oWPOb0",
          "name": "Virus Total | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "7bf3c7a0-94f9-410b-b0fe-e0d15d0ba895",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -1760,
        380
      ],
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "741f3221-bb73-4004-801e-e9c3030740f8",
      "name": "Find indicators of compromise",
      "type": "n8n-nodes-base.code",
      "position": [
        -780,
        440
      ],
      "parameters": {
        "language": "python",
        "pythonCode": "try:\n  from ioc_finder import find_iocs\nexcept ImportError:\n  import micropip\n  await micropip.install(\"ioc-finder\")\n  from ioc_finder import find_iocs\n\ntext = _input.first().json['body']['content']\nprint(text)\n\niocs = find_iocs(text)\n\nreturn [{\"json\": { \"domain\": item }} for item in iocs[\"urls\"]]"
      },
      "typeVersion": 2,
      "alwaysOutputData": true
    },
    {
      "id": "bf8ba285-e824-4104-82e0-fa2dba80f301",
      "name": "URLScan: Get report",
      "type": "n8n-nodes-base.urlScanIo",
      "position": [
        640,
        60
      ],
      "parameters": {
        "scanId": "={{ $json.scanId }}",
        "operation": "get"
      },
      "credentials": {
        "urlScanIoApi": {
          "id": "eva7ViJyyrpmJDe3",
          "name": "urlscan.io | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "eb3b06e8-ffe3-4472-a70c-08fb2555e0fb",
      "name": "URLScan: Scan URL",
      "type": "n8n-nodes-base.urlScanIo",
      "position": [
        -100,
        120
      ],
      "parameters": {
        "url": "={{ $json.domain }}",
        "additionalFields": {}
      },
      "credentials": {
        "urlScanIoApi": {
          "id": "eva7ViJyyrpmJDe3",
          "name": "urlscan.io | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 1,
      "continueOnFail": true
    },
    {
      "id": "34157694-635a-481b-b7d2-dcd4628b26fe",
      "name": "Has URL?",
      "type": "n8n-nodes-base.if",
      "position": [
        -520,
        440
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.domain }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "33cad369-0598-433e-90f8-0e7333ec5e92",
      "name": "No error?",
      "type": "n8n-nodes-base.if",
      "position": [
        240,
        120
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.error }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "cba20d52-a56c-4ac0-99f2-d9b54adb342e",
      "name": "Not empty?",
      "type": "n8n-nodes-base.filter",
      "position": [
        -640,
        1280
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.data }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "449c31e3-e098-43ec-a31b-1e383c6add57",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2051.228008430503,
        -251.94391274976795
      ],
      "parameters": {
        "width": 474.5187061049208,
        "height": 1008.8561536646063,
        "content": "![ì˜ˆì •ëœ](https://i.imgur.com/PcOuvAL.png)  \n## ì›Œí¬í”Œë¡œ ê°œìš”  \n\nì´ n8n ì›Œí¬í”Œë¡œëŠ” URLScan.ioì™€ VirusTotalì„ ì‚¬ìš©í•˜ì—¬ ì ì¬ì  í”¼ì‹± URLì„ ë¶„ì„í•˜ì—¬ ì‚¬ì´ë²„ ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ê°•í™”í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.  \n\nì´ ì›Œí¬í”Œë¡œëŠ” ë“¤ì–´ì˜¤ëŠ” ë©”ì‹œì§€ì—ì„œ URLì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ì•…ì„± ì½˜í…ì¸  ì—¬ë¶€ë¥¼ í‰ê°€í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.  \n\nì´ ì›Œí¬í”Œë¡œëŠ” íŠ¹íˆ `Outlook`ì— ë§ì¶°ì ¸ ìˆì§€ë§Œ, ì›í•˜ëŠ” ë©”ì¼ ì œê³µìë¡œ outlookì„ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\nì›Œí¬í”Œë¡œëŠ” ìˆ˜ë™ìœ¼ë¡œ ì‹œì‘í•˜ê±°ë‚˜ ìë™ìœ¼ë¡œ ì˜ˆì•½í•˜ì—¬ í”¼ì‹± ìœ„í˜‘ì— ëŒ€í•œ ì¼ê´€ëœ ê²€ì‚¬ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤. ì£¼ìš” ì‚¬ì´ë²„ ë³´ì•ˆ ë„êµ¬ì™€ í†µí•©í•˜ì—¬ í¬ê´„ì ì¸ ë¶„ì„ì„ ì œê³µí•˜ë©°, ì¡°ì§ì˜ í”¼ì‹± ê³µê²© ë°©ì–´ ëŠ¥ë ¥ì„ ê°•í™”í•©ë‹ˆë‹¤.  \n\n## ì‹¤í–‰ ì¼ì •  \n\nì›í•˜ëŠ” ëŒ€ë¡œ \"ì›Œí¬í”Œë¡œ ì‹¤í–‰\"ì„ í´ë¦­í•˜ì—¬ íŠ¸ë¦¬ê±°í•˜ê±°ë‚˜ ì¼ì •ì— ë”°ë¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš´ì˜ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ `ìŠ¤ì¼€ì¤„ íŠ¸ë¦¬ê±°`ë¥¼ ì›í•˜ëŠ” ë¹ˆë„ë¡œ ì‚¬ìš©ì ì •ì˜í•˜ì—¬ í”¼ì‹± ì‹œë„ì— ëŒ€í•œ ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ì„ ë³´ì¥í•©ë‹ˆë‹¤.  \n\n### ì¶œë ¥"
      },
      "typeVersion": 1
    },
    {
      "id": "a8921212-aec4-422d-9f04-f402d7591475",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1560,
        107
      ],
      "parameters": {
        "width": 397.3953488372091,
        "height": 647.1076277970203,
        "content": "![ì•„ì›ƒë£©](https://i.imgur.com/R3Bhd8I.png)  \n## í”¼ì‹± ë¶„ì„ì„ ìœ„í•œ ì´ë©”ì¼ ì²˜ë¦¬  \nì´ ì›Œí¬í”Œë¡œì˜ ì´ ë¶€ë¶„ì€ Microsoft Outlookê³¼ ì¸í„°í˜ì´ìŠ¤í•˜ì—¬ `ì½ì§€ ì•Šì€ ëª¨ë“  ë©”ì‹œì§€`ë¥¼ ê²€ìƒ‰í•˜ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ ì„¹ì…˜ì€ ë‹¤ë¥¸ ë©”ì¼ ì œê³µìë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\nì´ë©”ì¼ì´ ê°€ì ¸ì˜¤ë©´, `ëª¨ë“  ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°` ë…¸ë“œê°€ ì„¸ë¶€ ì‚¬í•­ì„ ìº¡ì²˜í•˜ê³ , `ì½ìŒìœ¼ë¡œ í‘œì‹œ` ë…¸ë“œê°€ ë©”ì‹œì§€ì˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.  \n\nì´ê²ƒì€ ê° ì´ë©”ì¼ì´ í•œ ë²ˆë§Œ ì²˜ë¦¬ë˜ë„ë¡ í•˜ì—¬, ê¹¨ë—í•˜ê³  ì˜ ì •ë¦¬ëœ ì¸ë°•ìŠ¤ë¥¼ ìœ ì§€í•˜ê³ , ë™ì¼í•œ ë©”ì‹œì§€ì˜ ì¬ì²˜ë¦¬ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "fbad734e-4502-4d1b-8890-b05c486a1f70",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1140,
        15.062288067451163
      ],
      "parameters": {
        "width": 859.9418604651164,
        "height": 836.8098049558043,
        "content": "![íŒŒì´ì¬](https://i.imgur.com/S2TZ3u6.png)  \n## íƒ€í˜‘ ì§€í‘œ ê°ì§€ ë£¨í”„  \nì´ ì›Œí¬í”Œë¡œ ì„¹ì…˜ì€ n8nì˜ `Split In Batches` ë…¸ë“œë¥¼ í™œìš©í•˜ì—¬ ë°˜ë³µ ì²˜ë¦¬ì˜ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì´ìš©í•©ë‹ˆë‹¤. ì´ë©”ì¼ ë°°ì¹˜ë¥¼ í•˜ë‚˜ì”© ë¶„í•´í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ê° ë©”ì‹œì§€ì˜ ë‚´ìš©ì„ ê°œë³„ì ìœ¼ë¡œ ê²€ì‚¬í•˜ì—¬ ì ì¬ì  ìœ„í˜‘ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\n`Find indicators of compromise` ë…¸ë“œë¥¼ í†µí•´ ì›Œí¬í”Œë¡œëŠ” Python ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë©”ì¼ ë‚´ìš©ì„ ë¶„ì„í•˜ê³  í”¼ì‹± ì‹œë„ì—ì„œ ì¼ë°˜ì ì¸ íƒ€í˜‘ ì§€í‘œ(IoCs)ì¸ URLì„ ì¶”ì¶œí•©ë‹ˆë‹¤. ioc-finder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ì´ë©”ì¼ ë³¸ë¬¸ì—ì„œ ì´ëŸ¬í•œ IoCsë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê²€ìƒ‰í•˜ê³  ë¶„ë¦¬í•©ë‹ˆë‹¤.  \n\n`Has URL?` ë…¸ë“œëŠ” ì´ë©”ì¼ì— URLì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. URLì´ ì—†ìœ¼ë©´ ë£¨í”„ê°€ ë‹¤ìŒ ì´ë©”ì¼ë¡œ ë„˜ì–´ê°€ë©°, ê²€ì‚¬í•  ë‚´ìš©ì´ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. URLì´ ë°œê²¬ë˜ë©´ ì´ë©”ì¼ì´ ë‹¤ìŒ ì„¹ì…˜ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.  \n\në°°ì¹˜ ë¶„í• ì€ ì›Œí¬í”Œë¡œì˜ íš¨ìœ¨ì„±ì„ ìœ„í•´ í•µì‹¬ì ì´ë©°, ëŒ€ëŸ‰ì˜ ì´ë©”ì¼ì„ ì²´ê³„ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ê° ì´ë©”ì¼ì—ì„œ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ìš”ì†Œë¥¼ ì •í™•íˆ ì‹ë³„í•˜ê³  ì¶”ì¶œí•˜ì—¬ ì›Œí¬í”Œë¡œì˜ ì„¸ë°€í•œ ë³´ì•ˆ ë¶„ì„ ì ‘ê·¼ ë°©ì‹ì„ ê°•ì¡°í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "8603fe5b-ad6b-4980-a28b-01531c6629f3",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -260,
        -313.5039999999999
      ],
      "parameters": {
        "width": 1099.116279069767,
        "height": 618.8295813953489,
        "content": "![urlscan](https://i.imgur.com/RjaMt6c.png)  \n## URL ìŠ¤ìºë‹ ë° ê²€ì¦  \nì´ ì›Œí¬í”Œë¡œì˜ ì´ ë¶€ë¶„ì€ URLScan.ioì™€ ìƒí˜¸ì‘ìš©í•˜ë©°, ì ì¬ì ì¸ ë³´ì•ˆ ìœ„í˜‘ì— ëŒ€í•œ ì›¹ì‚¬ì´íŠ¸ ìŠ¤ìº” ë° ë¶„ì„ ë„êµ¬ì…ë‹ˆë‹¤.  \n\n`URLScan: Scan URL` ë…¸ë“œëŠ” ì´ë©”ì¼ ë‚´ìš©ì—ì„œ ì¶”ì¶œëœ URLì„ ì œì¶œí•˜ì—¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë”ë¼ë„ ê³„ì† ì§„í–‰ë˜ë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´, `No error?` ë…¸ë“œì—ì„œ ì˜¤ë¥˜ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\nì´ëŠ” `URLScan: Scan URL` ë…¸ë“œê°€ ì‹¤íŒ¨í•  ê²½ìš° ì „ì²´ ì›Œí¬í”Œë¡œê°€ ì¤‘ì§€ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì´ë¡ ì ìœ¼ë¡œëŠ” ì´ ì´ë©”ì¼ ì²˜ë¦¬ í›„ ë‹¤ë¥¸ ì´ë©”ì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì›Œí¬í”Œë¡œê°€ ë‹¤ìŒ ì´ë©”ì¼ë¡œ ì´ë™í•´ì•¼ í•©ë‹ˆë‹¤.  \n\nì œì¶œ í›„, `Wait 1 Minute` ë…¸ë“œëŠ” ì›Œí¬í”Œë¡œë¥¼ ì¼ì‹œ ì¤‘ì§€í•˜ì—¬ URLScan.ioê°€ ìŠ¤ìº”ì„ ìˆ˜í–‰í•˜ê³  ë³´ê³ ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ì‹œê°„ì„ ì¤ë‹ˆë‹¤. ì´ ëŒ€ê¸° ì‹œê°„ì€ ë³´ê³ ì„œ ê²€ìƒ‰ ì‹œ ê°€ì¥ ìµœê·¼ì´ê³  í¬ê´„ì ì¸ ë¶„ì„ì„ ë°˜ì˜í•˜ë„ë¡ í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "33299274-9f02-4ea0-af60-5dee53db2c34",
      "name": "Wait 1 Minute",
      "type": "n8n-nodes-base.wait",
      "position": [
        480,
        60
      ],
      "webhookId": "469a8b5e-8b5a-4360-bc9d-3b253cc0ae24",
      "parameters": {
        "unit": "seconds",
        "amount": 60
      },
      "typeVersion": 1
    },
    {
      "id": "757ad81d-ae24-4b26-98ba-a571670be2a3",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -260,
        318.64011851851865
      ],
      "parameters": {
        "width": 1435.7278194659766,
        "height": 540.6919228251508,
        "content": "### ë²ˆì—­ ê²°ê³¼\n\nì‚¬ìš©ìê°€ ì œê³µí•œ ì…ë ¥ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë¯€ë¡œ, ë²ˆì—­í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ì´ëŠ” ì‹œìŠ¤í…œ ì§€ì¹¨ì— ë”°ë¼ ì¶”ê°€ ì„¤ëª… ì—†ì´ ì²˜ë¦¬ëœ ê²°ê³¼ì…ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "8e2cbf69-6c9e-4a98-ba5e-29b93eb2742f",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -680,
        880
      ],
      "parameters": {
        "width": 1213.8313506082789,
        "height": 575.5779026440933,
        "content": "![Slack](https://i.imgur.com/iKyMV0N.png)  \n## í”¼ì‹± ë¶„ì„ ìµœì¢… ë³´ê³   \nì›Œí¬í”Œë¡œì˜ ê²°ë¡  ë‹¨ê³„ì—ì„œ, ë¶„ì„ì„ ì‹¤í–‰ ê°€ëŠ¥í•œ ì •ë³´ë¡œ í†µí•©í•˜ê³  Slackì„ í†µí•´ ë³´ê³ í•©ë‹ˆë‹¤.  \n\n`Not empty?` ë…¸ë“œëŠ” ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ì—¬, ë¶„ì„ì´ ì™„ë£Œëœ URLë§Œ ë³´ê³  ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë„ë¡ í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ë¶ˆì™„ì „í•œ ë°ì´í„°ì— ëŒ€í•œ ê²½ë³´ë¥¼ í”¼í•˜ê¸° ìœ„í•´ ì¤‘ìš”í•˜ë©°, ì´ëŠ” ì˜ëª»ëœ ê²°ì •ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  \n\n`sends slack message` ë…¸ë“œëŠ” ì›Œí¬í”Œë¡œì˜ ìµœì¢… ì ‘ì ìœ¼ë¡œ, ìì„¸í•œ ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ì—¬ Slackì— ê²Œì‹œí•©ë‹ˆë‹¤. ì´ ë©”ì‹œì§€ì—ëŠ” ë¶„ì„ëœ ì´ë©”ì¼ì˜ `ì œëª©, ë°œì‹ ì, ë° ë‚ ì§œ`ì™€ í•¨ê»˜ URLScan ë° VirusTotal ë³´ê³ ì„œê°€ í¬í•¨ë©ë‹ˆë‹¤. ë˜í•œ, ì•…ì„± ë° ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í”Œë˜ê·¸ì˜ ìˆ˜ë¥¼ ì „ì²´ ê²€ì‚¬ íšŸìˆ˜ì™€ ë¹„êµí•˜ì—¬ ê°„ê²°í•œ íŒë‹¨ì„ ì œê³µí•˜ë©°, ì ì¬ì  ìœ„í˜‘ ìˆ˜ì¤€ì„ ëª…í™•íˆ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.  \n\nì´ Slack ì•Œë¦¼ì€ ì‚¬ì´ë²„ ë³´ì•ˆ íŒ€ì´ ì ì ˆí•œ ì¡°ì¹˜ë¥¼ ì·¨í•˜ë„ë¡ ì´‰êµ¬í•˜ë©°, ì›Œí¬í”Œë¡œì˜ ëª©ì ì¸ íš¨ìœ¨ì ì´ê³  ì •í™•í•˜ë©° ì‹œì˜ì ì ˆí•œ í”¼ì‹± ìœ„í˜‘ ë¶„ì„ì„ ì™„ë£Œí•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "a2a0dc81-b1f0-4d7b-b818-71bae58512a9",
      "name": "Get all unread messages",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        -1520,
        560
      ],
      "parameters": {
        "operation": "getAll",
        "additionalFields": {
          "filter": "isRead eq false"
        }
      },
      "credentials": {
        "microsoftOutlookOAuth2Api": {
          "id": "Zeu3LbjDbkwiCUik",
          "name": "Microsoft Outlook | Giulio [âœ… Share ok]"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "a5793014-9575-4e05-b467-f295a09f0945",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -260,
        320
      ],
      "parameters": {
        "width": 615.527819465977,
        "height": 540.6919228251508,
        "content": "![VirusTotal](https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/VirusTotal_logo.svg/320px-VirusTotal_logo.svg.png)  \n## VirusTotalì„ ì‚¬ìš©í•œ í”¼ì‹± URL ë¶„ì„  \nì´ ì›Œí¬í”Œë¡œì˜ ì´ ë¶€ë¶„ì€ VirusTotalì˜ ê¸°ëŠ¥ì„ ë°°ì¹˜í•˜ì—¬ URLì„ í”¼ì‹± ì§•í›„ì— ëŒ€í•´ ì¡°ì‚¬í•©ë‹ˆë‹¤.  \n\n`VirusTotal: URL ìŠ¤ìº”` ë…¸ë“œëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•˜ì—¬ URLì„ VirusTotalì— ë³´ë‚´ ë¶„ì„í•©ë‹ˆë‹¤. ìŠ¤ìº”ì´ íŠ¸ë¦¬ê±°ëœ í›„, ì›Œí¬í”Œë¡œëŠ” `VirusTotal: ë³´ê³ ì„œ ê°€ì ¸ì˜¤ê¸°` ë…¸ë“œë¡œ ì´ë™í•˜ì—¬ ì¼ì • ê°„ê²© í›„ì— ìì„¸í•œ ë¶„ì„ ë³´ê³ ì„œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë°›ì€ ë°ì´í„°ì— ìŠ¤ìº”ì˜ ëª¨ë“  ë°œê²¬ì´ í¬í•¨ë˜ë„ë¡ í•©ë‹ˆë‹¤.  \n\në§ˆì§€ë§‰ìœ¼ë¡œ, `ë³´ê³ ì„œ ë³‘í•©` ë…¸ë“œëŠ” URLScan.ioê³¼ VirusTotalì˜ ê²°ê³¼ë¥¼ ê²°í•©í•˜ì—¬ ë°ì´í„°ë¥¼ ë‚˜ë€íˆ ì •ë ¬í•˜ì—¬ ì¢…í•©ì ì¸ ë³´ê¸°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ìœ„ì¹˜ì— ì˜í•œ ë³‘í•©ì€ ë‹¤ë¥¸ ì†ŒìŠ¤ì—ì„œ ë¶„ì„ì„ ìƒí˜¸ ì—°ê²°í•˜ì—¬ í•´ë‹¹ URLì˜ ë‹¤ì¸µ ë³´ì•ˆ í‰ê°€ë¥¼ ì œê³µí•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤."
      },
      "typeVersion": 1
    },
    {
      "id": "c8d5c248-77ba-4a7f-ab21-19ff8d60ed55",
      "name": "Merge Reports",
      "type": "n8n-nodes-base.merge",
      "position": [
        1040,
        680
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combinationMode": "mergeByPosition"
      },
      "typeVersion": 2.1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "02ba918c-5fee-4d3e-824f-1160881716b6",
  "connections": {
    "Has URL?": {
      "main": [
        [
          {
            "node": "URLScan: Scan URL",
            "type": "main",
            "index": 0
          },
          {
            "node": "VirusTotal: Scan URL",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Split In Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No error?": {
      "main": [
        [
          {
            "node": "Merge Reports",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait 1 Minute",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Not empty?": {
      "main": [
        [
          {
            "node": "sends slack message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mark as read": {
      "main": [
        [
          {
            "node": "Split In Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Reports": {
      "main": [
        [
          {
            "node": "Split In Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 1 Minute": {
      "main": [
        [
          {
            "node": "URLScan: Get report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get all unread messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split In Batches": {
      "main": [
        [
          {
            "node": "Find indicators of compromise",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Not empty?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "URLScan: Scan URL": {
      "main": [
        [
          {
            "node": "No error?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "URLScan: Get report": {
      "main": [
        [
          {
            "node": "Merge Reports",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VirusTotal: Scan URL": {
      "main": [
        [
          {
            "node": "VirusTotal: Get report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VirusTotal: Get report": {
      "main": [
        [
          {
            "node": "Merge Reports",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Get all unread messages": {
      "main": [
        [
          {
            "node": "Mark as read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find indicators of compromise": {
      "main": [
        [
          {
            "node": "Has URL?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Execute Workflow\"": {
      "main": [
        [
          {
            "node": "Get all unread messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}